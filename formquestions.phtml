<?php
/*if(empty($_SESSION['opt'])) {
    
    require_once 'formquestions-old.phtml';
} else {*/

/**
----------------------------------------------------------------------------------------------------------
SrNo    Date        Modified By         Comment
----------------------------------------------------------------------------------------------------------
00002   22-06-2015  Deepali P           Updated for Referring Provider as optional
00001   06-06-2015  Rohit K             Updated for surgical_date parameter
----------------------------------------------------------------------------------------------------------
*/
?>
<?php
$signatureFieldExist    =   'false';
$sessionCobrand	=	new Zend_Session_Namespace('cobrand');
//$this->isMobile = true;
?>

<script>
	$('#page_back').attr('href','#').show();
	$('#page_back').unbind('click');
	$('#page_back').click(function(){
        acceptNSignClicked = false;
        //in case of pre registration we using history back 
            if($.trim(preRegister) != ''){
                window.history.back();
                return false;
            }
            
        if($('.formWrap').is(':visible')){
            
            <?php 
                foreach ($this->allformids AS $idsKey => $idsVal) {
                    if ($idsVal == $this->formId) {
                        if ($idsKey > 0) {
                            echo "loadQuestions(\"" . $this->allformids[($idsKey-1)] . "\",\"" . $this->formId . "\",\"back\")";
                        } else if (!empty($sessionCobrand->isCheckin)) {
                            echo "window.location.href='".$this->backurl."';";
                        } else if (isset($sessionCobrand->fromApptBokkingPopup) && !empty($sessionCobrand->fromApptBokkingPopup)) {
                            echo "window.location.href='/patient/doctor/appointmentdetails/appointment_id/".$this->appointIds."';";
                        }
                    }
                }
            ?>
        }else{
            $('.formWrap').show();
            $('#signBox').hide();
            $('#signBoxPlaceholder').hide();
        }
	});
</script>



<?php
/*echo "<pre>";
print_r($this->formDetails);*/

foreach ($this->formDetails as $key1 => $value) {
 if(!empty($value['practice_id']))
 {
    $provider = new Application_Model_Providers();
    $practiceData = $provider->fetchPracticeByFieldName('id',$value['practice_id']);
 } 
    ?>

    <form id="form_<?php echo $value["id"];?>" name="form_<?php echo $value["id"];?>" onsubmit="return false;">
        <input type="hidden" name="formidnow" id="formidnow" value="<?php echo $value["id"];?>">
        <input type="hidden" name="practice_id" id="practice_id" value="<?php echo $value["practice_id"];?>">
        <div>
            <ul class="questionerList">
                <?php 
		$question = 0;

                foreach ($value['questions'] AS $quesKey => $quesVal) {
                    
                    if($quesVal['category_name'] != $category && $quesVal['category_name'] != "" && $quesVal['parent_ques_id'] == "" && !in_array($quesVal['category_name'],array('Insurance Information','For Office Use Only','Complete at Time of Study','Consent for MRI with Contrast Injection','Consent CT Scan Dye Use','OR','FOR PROSCAN IMAGING USE ONLY - RECEIPT OF NOTICE OF PRIVACY PRACTICES ONLY','CCTA (coronary computed tomography angiography) MEDICATIONS','PLEASE DO NOT WRITE IN THIS AREA<br> CT SCREENING TEST RESULT CATEGORY','Print Out- Tech View'))) {
                        $ctr=0;?>

                        <?php $fieldType = explode('|', $quesVal['type']);
                        
                        if($fieldType[1] != 'techquestions' || $fieldType[1] !='combinePdfOnly'){ 
                            //echo $fieldType[1];
                        ?>
                        <li class="questionerList_h1 content-subheading clearboth">                            
                            <h1 class="questionerTlt"><?php echo $quesVal['category_name'];?> <i class="fa fa-arrow-down"></i></h1>
                        </li>
                        <?php } ?>
                    <?php   
                        $liborder = 'questionerList_liNoBorder';
                    } elseif(in_array($quesVal['id'], array('448','968', '886', '885')) || $quesVal['category_name'] == 'Additional Information') {
                        $liborder = 'questionerList_liNoBorder';
                    } else {
                        $liborder = 'questionerList_liBorder';
                    }
                    
                    if($quesVal['category_name'] == '' && $category == '' && $quesVal['question_text'] == '')
                    {
                        $liborder = 'questionerList_liNoBorder';
                    }
                    
                    if ($ctr == 0 && $quesVal['id'] != 1709) {
                        $liborder = 'questionerList_liBorder';
                    }
                    else if($quesVal['id'] == 1709){
                        $liborder = 'questionerList_liNoBorder';
                    }

                    if(in_array($quesVal['id'], array('892','483','484','1008', '485'))) {
                        $liborder = 'questionerList_liBorder';
                    }

                    if($quesVal['id'])
                    {
                    $category = $quesVal['category_name'];
                    }
                    if($quesVal['optional'] == 1) {
                        $optional = 'optional="true"';
                        $mandatory = '';     
                    } else {
                        $optional = 'optional="false"';
                        $mandatory = '<span class="fieldStarB" style="padding-left: 15px;float: left;line-height: 8px;">*</span>&nbsp;';   
                    }
                    
                    if($quesVal['dont_ask'] == 'true' || $value['questions'][$quesVal['parent_ques_id']]['dont_ask'] == 'true') {
                        $quesVal['display'] = 'none';                         
                     
                    }
                    
                    if($quesVal['parent_answer'] == 'Blank' && $value['questions'][$quesVal['parent_ques_id']]['display'] == 'none'){
                        $quesVal['display'] = 'none';                         
                         
                    }

                    if($quesVal['display'] != "none") {
			$ctr++;
		    }
                    
                    $answerArr = explode('|', $quesVal['question_answers']); 
                    $age = $quesVal['patient_age'];
                    $display = "show";
                    if($quesVal['age_limit'] == '<18' ) {
                        if(!($age <= 18)) { 
                            $display = "hide";
                        }
                    } elseif ($quesVal['age_limit'] == '>18' ) {
                        if(!($age > 18)) {
                            $display = "hide";
                        }
                    }					

                    if( $display == 'show' ) {
                        if($quesVal['parent_ques_id'] != "" && $quesVal['parent_ques_id'] != 2124 && $quesVal['parent_ques_id'] != 2148 && $quesVal['parent_ques_id'] != 2166 && $quesVal['parent_ques_id'] != 2200 && $quesVal['parent_ques_id'] != 2225) {                          
                            $subClass = 'dependSub_li';                                
                            $btnYesNoClass = 'btnYesNo_indent';
                            $liborder = "";
                        } else {
                            if($quesVal['answer_type'] == 'signature') {
                                $liborder = "";
                            } 

                                if($quesVal['id'] == '2051'){
                                    $subClass = 'row indent_outer questionerList_liBorder'; 
                                }  
                                else{
                                    $subClass = 'indent_outer '.$liborder ;
                                }

                            $btnYesNoClass = 'btnYesNo';
                        }
                        
                        $parentAnswer = '';
                        if($quesVal['parent_answer']){
                            $parentAnswer = 'parent_answer = "'.$quesVal['parent_answer'].'"';
                        }
                        $autofocus = "";
                        if ($question == 0)
                            $autofocus = "autofocus";
                        
                        $fieldTypeGlobal = explode('|', $quesVal['type']);
                        if(strpos($fieldTypeGlobal[2], 'Child_') !== FALSE) {
                            $arrParentQuestions    = explode('_',$fieldTypeGlobal[1]);
                            $arrChildQuestions     = explode('_',$fieldTypeGlobal[2]);
                            
                            if($arrParentQuestions)
                            {
                                if($quesVal['patient_answers'] == 'No')
                                {
                                    if($arrChildQuestions)
                                    {
                                        echo "<script type='text/javascript'> $(document).ready(function() { openChild('".$arrChildQuestions[1]."', 'No', '".$arrParentQuestions[1]."'); });</script>";
                                    }                                    
                                }
                            }
                        }
                        
		switch ($quesVal['answer_type']) {
                case 'radio':
                    $fieldType = explode('|', $quesVal['type']);

                    $disabled = " display: ".$quesVal['display'];
                    if($quesVal['id'] == '190'){
                        if($quesVal['patient_answers'] == 'No'){
                            $disabled = " display: none; ";
                        }
                        
                    } 
                    if($value['practice_id'] == 1223 || $value['practice_id'] == 1211)
                    {
                       $quesVal['question_text'] = str_replace("###PRACTICE_NAME###", "OpenDoctors", $quesVal['question_text']);

                    }
                    else if($value['practice_id'] == 1299 )
                    {
                       $quesVal['question_text'] = str_replace("###PRACTICE_NAME###", $practiceData['practice_name'], $quesVal['question_text']);

                    }
                    
                    if(($quesVal['id'] == '201' && $this->answerCount201 == false ) || ($quesVal['id'] == '1036' && $this->answerCount1036 == false) ){
                        if($quesVal['patient_answers'] == 'Yes'){
                            $disabled = " display: none; ";
                        }                        
                    }
                    
                    if($quesVal['id'] == '846')
                    {
                       $btnYesNoClass = 'btnYesNo_846';  
                    }
                    
                    if($fieldType[1] != 'techquestions'){
                    
                    ?>
                    <li class="listbox" <?php echo $parentAnswer; ?> validClass="<?php echo $quesVal['validate_class']; ?>" errorlabel="<?php echo $quesVal['error_label']; ?>" style="width:<?php echo $quesVal['width'] . '%'; ?>;<?php echo $disabled; ?>" <?php
                    if ($quesVal['parent_ques_id']) {
                        echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'";
                    }?>>                              
                    <div class="row <?php echo $subClass; ?>">
                        <div class="questionTxt col-lg-9 col-md-9 col-sm-12 col-xs-12"><?php 
                        echo $mandatory;    echo $quesVal['question_text'];
                        if ($quesVal['has_dependent_form'] == '1') {?>
                            <input type="hidden" name="has_dependent_form_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['has_dependent_form']; ?>" <?php echo $optional; ?>>
                    <?php } ?>
                        </div>
                    <div class="mob-margin-top-15 col-lg-3 col-md-3 col-sm-12 col-xs-12 <?php echo $btnYesNoClass; ?> btn-group">
                    <?php
                    $count = count($answerArr);
                    //echo $quesVal['depend'];

                    foreach ($answerArr AS $AnswerKey => $AnswerVal) {
                        $question++;
                        $tabindex = 'tabindex="' . $question . '"';?>
                        <?php if($count > 2) {
                            echo "<label id='Label_".$quesVal['id'] . '_' . $AnswerKey."' class='btn btn-default ";
                            
                            /*if ($AnswerKey == '0'){
                                echo ' lft ';
                            }else{
                                echo ' rht ';
                            }*/
                            /*if($quesVal['id'] == '846'){
                                echo  ' RadioLabelClass_846 ' ;                   
                            } else {
                                echo  ' RadioLabelClass ' ;
                            }*/
                            if ($quesVal['patient_answers'] == $AnswerVal) {
                                if($quesVal['id'] == '846'){
                                echo  ' RadioSelected_846 ' ;                   
                                } else {
                                echo ' RadioSelected ';
                                echo ' ';
                                }
                            }
                            echo "'";

                            // echo " for=answer_radio_".$quesVal['id'] . '_' . $AnswerKey;
                            echo " for=''";?>

                            onclick="markChecked(this);<?php
                            if(strpos($fieldType[2], 'Child_') !== FALSE) {
                                $IntermediateArr = explode('_', $fieldType[2]);
                                $IntermediateParentArr = explode('_', $fieldType[1]);
                                echo "openChild('".$IntermediateArr[1]."', '".$AnswerVal."', '".$IntermediateParentArr[1]."');";
                            }
                            if ($quesVal['depend']) {
                                //if ($quesVal['depend'] == $AnswerVal) echo "showDependent('depend_" . $quesVal['id'] . "');";
                                if (in_array($AnswerVal, $quesVal['depend']))
                                    echo "hideDependent('depend_" . $quesVal['id'] . "'); showDependent('depend_" . $quesVal['id'] . "','" . $AnswerVal . "');";
                                else
                                    echo "hideDependent('depend_" . $quesVal['id'] . "');";
                            }
                            ?>" onkeyup="onkeySelectButton(event, this, '<?php echo $quesVal['depend']; ?>', '<?php echo $AnswerVal; ?>', '<?php echo $quesVal['id']; ?>');" 
                            <?php echo $tabindex." ". $autofocus; ?>>
                            <?php
                        }
                        else{
                            $strLen =  strlen($AnswerVal);
                            if($strLen > 3 || $quesVal['id'] == 2148){
                                echo "<div class='col-lg-12 col-md-12 col-sm-12 col-xs-12 padding-0 fullwidthbutton'>";
                            }else{
                                echo "<div class='col-lg-6 col-md-6 col-sm-6 col-xs-6 padding-0'>";
                            }

                        }?>
                        <!-- <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 padding-0"> -->
                        <input type="radio" name="answer_radio_<?php echo $quesVal['id']; ?>[]" id="answer_radio_<?php echo $quesVal['id'] . "_" . $AnswerKey; ?>" value="<?php echo $AnswerVal; ?>" <?php if($count > 2) echo "style='display:none;'";?> <?php
                        if ($quesVal['patient_answers'] == $AnswerVal) {
                            echo 'checked="checked"';
                        }
                        ?> class="RadioClass" <?php echo $optional; ?>>
                        <?php if($count > 2){
                            echo $AnswerVal;
                        }
                        else {?>
                            <div id="Label_<?php echo $quesVal['id'] . '_' . $AnswerKey; ?>" for="answer_radio_<?php echo $quesVal['id'] . '_' . $AnswerKey; ?>" class="<?php
                                if($count <3){
                                if ($AnswerKey == '0')
                                echo 'lft';
                                else
                                echo 'rht';
                            }
                        ?>  <?php
                        if($quesVal['id'] == '846'){
                            echo  'RadioLabelClass_846 ' ;                   
                            } else {
                            echo  'RadioLabelClass ' ;
                        }
                        if ($quesVal['patient_answers'] == $AnswerVal) {
                            if($quesVal['id'] == '846'){
                                echo  'RadioSelected_846 ' ;                   
                            } else {
                                echo 'RadioSelected';
                            }
                          
                        }
                        ?>" onclick="markChecked(this);<?php
                        if(strpos($fieldType[2], 'Child_') !== FALSE) {
                            $IntermediateArr = explode('_', $fieldType[2]);
                            $IntermediateParentArr = explode('_', $fieldType[1]);
                            echo "openChild('".$IntermediateArr[1]."', '".$AnswerVal."', '".$IntermediateParentArr[1]."');";
                        }
                        if ($quesVal['depend']) {
                            //if ($quesVal['depend'] == $AnswerVal) echo "showDependent('depend_" . $quesVal['id'] . "');";
                            if (in_array($AnswerVal, $quesVal['depend']))
                                echo "hideDependent('depend_" . $quesVal['id'] . "'); showDependent('depend_" . $quesVal['id'] . "','" . $AnswerVal . "');";
                            else
                                echo "hideDependent('depend_" . $quesVal['id'] . "');";
                        }
                        ?>" onkeyup="onkeySelectButton(event, this, '<?php echo $quesVal['depend']; ?>', '<?php echo $AnswerVal; ?>', '<?php echo $quesVal['id']; ?>');" <?php echo $tabindex . " " . $autofocus; ?>><?php echo $AnswerVal; ?></div>
                        <?php } ?>
                        <?php if($count > 2){
                            echo "</label>";
                        }
                        else{
                            echo "</div>";
                        }
                        ?>
                        <!-- </div> -->    
                        <?php  
                        } ?>
                        </div>
                                     
                        </div>
                    </li>
                    <?php
                    }
                    break;
                case 'multi-radio':
                    
                    $width = "";
                    $fieldType = explode('|', $quesVal['type']);
                    if ($fieldType['2'] == "4") {
                        $width = "width:25%;float:left";
                       
                    } elseif ($fieldType['2'] == "3") {
                        $width = "width:33%;";
                    } elseif ($fieldType['2'] == "1") {
                        $width = "width:100%;";
                    }elseif ($fieldType['2'] == "1") {
                        $width = "width:100%;";
                    }
                   
                    if ($fieldType[2] == 'ageCheck') {

                    ?>   
                    <li class="listbox" <?php echo $parentAnswer; ?> validClass="<?php echo $quesVal['validate_class']; ?>" errorlabel="<?php echo $quesVal['error_label']; ?>" style=display:<?php echo $quesVal['display']; ?> <?php
                        if ($quesVal['parent_ques_id']) {
                            echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'";
                        }?>>
                        <div class="questionTxt col-lg-12 col-md-12 col-sm-12 col-xs-12"><?php
                       echo $mandatory;   echo $quesVal['question_text'];
                        if ($quesVal['has_dependent_form'] == '1') {
                        ?><input type="hidden" name="has_dependent_form_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['has_dependent_form']; ?>" <?php echo $optional; ?>>
                        <?php } ?>
                        </div>
                        <?php
                        $radioArr=  explode('|', $quesVal['question_answers']);
                        ?>
                        <br/>
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <table class="family_age" cellpadding="2" cellspacing="1" border="1" width="70%">
                                <tr>
                                    <th rowspan="2" >Family member</th>
                                    <th colspan="3">Age first discovered</th>
                                </tr>
                                <tr>
                                    <th>Under 55</th>
                                    <th>55 - 64</th>
                                    <th>65 & up</th>
                                </tr>
                                <?php
                                    $checkRadioArr = explode('|', $quesVal['patient_answers']);
                                    foreach ($radioArr as $key2 => $val) {?> 
                                <tr>
                                    <td><?php echo $val; ?></td>
                                    <td><input type="radio" isgroupradio = "isGroupRadio" value="<?php echo $key2.'_under55'; ?>" name="answer_radio_<?php echo $quesVal['id']; ?>[<?php echo $key2;?>]" id="answer_radio_<?php echo $quesVal['id'] . "_" . $key2; ?>" onblur="ajaxSave('answer_radio_<?php echo $quesVal['id']; ?>', this);" 
                                    <?php if (in_array($key2.'_under55' ,$checkRadioArr)) {
                                        echo 'checked="checked"';
                                    }?> ></td>
                                    <td><input type="radio" isgroupradio = "isGroupRadio" value="<?php echo $key2.'_55to65'; ?>" name="answer_radio_<?php echo $quesVal['id']; ?>[<?php echo $key2;?>]" id="answer_radio_<?php echo $quesVal['id'] . "_" . $key2; ?>" onblur="ajaxSave('answer_radio_<?php echo $quesVal['id']; ?>', this);" 
                                                <?php if (in_array($key2.'_55to65' , $checkRadioArr)) {
                                        echo 'checked="checked"';
                                    } ?>></td>
                                    <td><input type="radio" isgroupradio = "isGroupRadio" value="<?php echo $key2.'_65up'; ?>" name="answer_radio_<?php echo $quesVal['id']; ?>[<?php echo $key2;?>]" id="answer_radio_<?php echo $quesVal['id'] . "_" . $key2; ?>" onblur="ajaxSave('answer_radio_<?php echo $quesVal['id']; ?>', this);"
                                            <?php if (in_array($key2.'_65up' , $checkRadioArr)) {
                                    echo 'checked="checked"';
                                    } ?>></td>
                                </tr> <?php } ?>
                            </table>
                        </div>
                    </li>
                        <?php
                        
                    } 
                    else {
                        $minMaxCls = "max_min_height";
                        $padCls = "";
                        if($quesVal['id'] == '1086'){
                            $minMaxCls = '';
                            $padCls = 'padding_btm';
                        }
                        if($fieldType[1] != 'techquestions'){

                        ?>                                    
                        <li class="listbox <?php echo $padCls; ?>" <?php echo $parentAnswer; ?> validClass="<?php echo $quesVal['validate_class']; ?>" errorlabel="<?php echo $quesVal['error_label']; ?>" style="width:<?php echo $quesVal['width']; ?>%;display:<?php echo $quesVal['display']; ?>" <?php
                            if ($quesVal['parent_ques_id']) {
                                echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'";
                            }?>>
                            <div class="row <?php echo $subClass; ?>">
                                <div class="questionTxt col-lg-12 col-md-12 col-sm-12 col-xs-12 mb15"><?php
                                    echo $mandatory;  echo $quesVal['question_text'];
                                    if ($quesVal['has_dependent_form'] == '1') {?>
                                    <input type="hidden" name="has_dependent_form_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['has_dependent_form']; ?>" <?php echo $optional; ?>>
                                    <?php } ?>
                                </div>
                                <div class="btnYesNoMulti_sub col-lg-12 col-md-12 col-sm-12 col-xs-12"><?php
                                foreach ($answerArr AS $AnswerKey => $AnswerVal) {
                                $question++;
                                $tabindex = 'tabindex="' . $question . '"';
                            
                                /* ?><label for="answer_radio_<?php echo $quesVal['id']."_".$AnswerKey;?>" class="radioMulti ">
                                */
                            ?><label title="<?php echo $AnswerVal; ?>" for="answer_radio_<?php echo $quesVal['id'] . "_" . $AnswerKey; ?>" class=" radioMulti threeColumn <?php echo $minMaxCls; ?>" style="<?php echo $width; ?>">
                                <div style="float:left;width : 25px;">
                                    <input  type="radio" name="answer_radio_<?php echo $quesVal['id']; ?>[]" id="answer_radio_<?php echo $quesVal['id'] . "_" . $AnswerKey; ?>" value="<?php echo $AnswerVal; ?>" <?php
                                    if ($quesVal['patient_answers'] == $AnswerVal) {
                                        echo 'checked="checked"';
                                    }?> class="" <?php echo $optional; ?> onclick="<?php
                                    if($quesVal['depend']) {
                                        $onclickFunctionflag = false;
                                        $arrayDependKey = 0;
                                        foreach ($quesVal['depend'] as $key3 => $depend) {
                                            $arrDepend = explode("|", $depend);
                                            if (in_array($AnswerVal, $arrDepend)) {
                                                $onclickFunctionflag = true;
                                                $arrayDependKey = $key3;
                                                break;
                                            }
                                        }
                                        //if ($quesVal['depend'] == $AnswerVal) echo "showDependent('depend_" . $quesVal['id'] . "');";
                                        if ($onclickFunctionflag) {
                                            #added incase of parent asnser depend on multiple answer 
                                            if (strpos($quesVal['depend'][$arrayDependKey], "|") !== FALSE) {
                                                echo "hideDependent('depend_" . $quesVal['id'] . "');showDependent('depend_" . $quesVal['id'] . "','" . $quesVal['depend'][$arrayDependKey] . "');";
                                            } else {

                                                echo "hideDependent('depend_" . $quesVal['id'] . "');showDependent('depend_" . $quesVal['id'] . "','" . $AnswerVal . "');";
                                            }
                                        } 
                                        else{
                                            echo "hideDependent('depend_" . $quesVal['id'] . "');";
                                        }
                                    }
                                ?>" onblur="ajaxSave('answer_radio_<?php echo $quesVal['id']; ?>',this);" <?php echo $tabindex . " " . $autofocus; ?> >
                                </div>
                            <div style="float:left;width:80%"><?php echo $AnswerVal; ?> </div>
                            <?php
                                echo "</label>";
                            }
                            ?>
                        <?php }
                    }
                break;
                case 'radio-rating':
                    ?>  
                                                                <li class="listbox" <?php echo $parentAnswer; ?> validClass="<?php echo $quesVal['validate_class']; ?>" errorlabel="<?php echo $quesVal['error_label']; ?>" style="width:<?php echo $quesVal['width'] . '%'; ?>;display:<?php echo $quesVal['display']; ?>" <?php
                    if ($quesVal['parent_ques_id']) {
                        echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'";
                    }
                    ?>>
                                                    <script type="text/javascript">
                                                        $("input[name='answer_radio_<?php echo $quesVal['id']; ?>[]']:checked").each(function() {
                                                            if($(this).val() < 5 ){
                                                              $('#img_smile_sad_<?php echo $quesVal['id']; ?>').attr('class','smiley_icon_son');
                                                              $('#img_smile_happy_<?php echo $quesVal['id']; ?>').attr('class','smiley_icon_hoff');
                                                            } else if($(this).val() > 7 ){ 
                                                              $('#img_smile_sad_<?php echo $quesVal['id']; ?>').attr('class','smiley_icon_soff');
                                                              $('#img_smile_happy_<?php echo $quesVal['id']; ?>').attr('class','smiley_icon_hon');
                                                            } else {
                                                              $('#img_smile_sad_<?php echo $quesVal['id']; ?>').attr('class','smiley_icon_soff');
                                                              $('#img_smile_happy_<?php echo $quesVal['id']; ?>').attr('class','smiley_icon_hoff');
                                                            }
                                                        });
                                                        $("input[name='answer_radio_<?php echo $quesVal['id']; ?>[]']").click(function(){
                                                            $("input[name='answer_radio_<?php echo $quesVal['id']; ?>[]']:checked").each(function() {
                                                            if($(this).val() < 5 ){
                                                              $('#img_smile_sad_<?php echo $quesVal['id']; ?>').attr('class','smiley_icon_son');
                                                              $('#img_smile_happy_<?php echo $quesVal['id']; ?>').attr('class','smiley_icon_hoff');
                                                            } else if($(this).val() > 7 ){ 
                                                              $('#img_smile_sad_<?php echo $quesVal['id']; ?>').attr('class','smiley_icon_soff');
                                                              $('#img_smile_happy_<?php echo $quesVal['id']; ?>').attr('class','smiley_icon_hon');
                                                            } else {
                                                              $('#img_smile_sad_<?php echo $quesVal['id']; ?>').attr('class','smiley_icon_soff');
                                                              $('#img_smile_happy_<?php echo $quesVal['id']; ?>').attr('class','smiley_icon_hoff');
                                                            }
                                                        });
                                                        });
                                                    </script>
                                                                    <div class="row <?php echo $subClass; ?>">
                                                        <div class="questionTxt col-lg-12 col-md-12 col-sm-12 col-xs-12"><?php
                                                            echo $mandatory;   echo $quesVal['question_text'];
                                if ($quesVal['has_dependent_form'] == '1') { ?>
                                                            <input type="hidden" name="has_dependent_form_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['has_dependent_form']; ?>" <?php echo $optional; ?>>
                    <?php } ?>
                    											</div>
                                                    <div class="btnYesNoMulti col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                                                            <div id="img_smile_sad_<?php echo $quesVal['id']; ?>" class="smiley_icon_soff">Not Likely</div>
                                                                            <div class="ratingbar" style="float: left;width:41%;">
                    															<div style="">
                                    <?php foreach ($answerArr AS $AnswerKey => $AnswerVal) {
                        $question++;
                                        $tabindex = 'tabindex="' . $question . '"';?>
                                                            <div class="btnYesNoMulti_smiley">
                                                                                                <input type="radio" name="answer_radio_<?php echo $quesVal['id']; ?>[]" id="answer_radio_<?php echo $quesVal['id'] . "_" . $AnswerKey; ?>" onclick="ajaxSave('answer_radio_<?php echo $quesVal['id']; ?>');" value="<?php echo $AnswerVal; ?>" <?php
                        if ($quesVal['patient_answers'] == $AnswerVal) {
                            echo 'checked="checked"';
                        }
                    ?>  <?php echo $optional; ?> <?php echo $tabindex . " " . $autofocus; ?>><br/><?php echo $AnswerVal; ?>
                                                            </div>                                
                    <?php } ?>
                                                                     </div>
                    												 <div style="text-align: center; clear: both;">Neutral</div>
                    											</div>
                                                                            <div id="img_smile_happy_<?php echo $quesVal['id']; ?>" class="smiley_icon_hoff">Most likely</div>
                    								</div>
                        </div> 
                        <img src="/images/smile_icon_on.png"  class="hiddenPic">
                                            <img src="/images/smile_icon1_on.png"  class="hiddenPic">
                                                </li>

                    <?php
                    break;
                case 'checkbox':
                    $patientAnswerArr = explode('|', $quesVal['patient_answers']);
                    $width = "";
                    $fieldType = explode('|', $quesVal['type']);
                    if ($fieldType['2'] == "3") {
                        $width = "width:33%;";
                    } elseif ($fieldType['2'] == "1") {
                        $width = "width:100%;";
                    } elseif ($fieldType['2'] == "4") {
                        $width = "width:25%;";
                    }
                    
                     $inlineCls = "";
                    if($fieldType[3] == "clear"){
                        $clearVal = "clear:both;";
                    }elseif($fieldType[3] == "quest_ans_inline"){
                        $inlineCls = "chk_quest_ans_inline";
                    }

                    if($fieldType[1] != 'techquestions'){
                    ?>
                    <li class="listbox" <?php echo $parentAnswer; ?> validClass="<?php echo $quesVal['validate_class']; ?>" 
                    errorlabel="<?php echo $quesVal['error_label']; ?>" style="width:<?php echo $quesVal['width']; ?>%;display:<?php echo $quesVal['display']; ?>;<?php echo $clearVal; ?>" <?php
                        if ($quesVal['parent_ques_id']) {
                            echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'";
                        }?>>
                        <div class="row <?php echo $subClass; ?>">
                            <?php
                             // $mandatory = '<span class="fieldStarB" style="padding-left: 15px;float: left;line-height: 8px;">*</span>&nbsp;';   
                               if(!empty($quesVal['question_text'])){
                                echo '<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 mb15"> '.$mandatory.$quesVal['question_text'].'</div>';
                              }else{
                                $mandatory = '<span class="fieldStarB" style="margin-left: -5px;float: left;line-height: 8px;">*</span>&nbsp;'; 
                                echo '<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 checkmb" style="line-height: 12px"> '.$mandatory.$quesVal['question_text'].'</div>';
                            }
                              
                            
                            if ($quesVal['has_dependent_form'] == '1') {?>
                                <input type="hidden" name="has_dependent_form_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['has_dependent_form']; ?>" <?php echo $optional; ?>>
                            <?php }
                            // echo $mandatory;
                            ?>
                                
                            <div class="indent_inner col-lg-12 col-md-12 col-sm-12 col-xs-12 <?php echo $inlineCls; ?>" style="width: 92%;">
                                <ul class="checkList"> <?php
                                    //$fieldType = explode('|',$quesVal['type']);
                                    $tableClass = "";
                                    if ($fieldType[1] && $fieldType[1] == 'table') {
                                        $tableClass = " table";
                                    }
                                    foreach ($answerArr AS $AnswerKey => $AnswerVal) {
                                        $question++;
                                        $tabindex = 'tabindex="' . $question . '"';
                                    ?>
                                    <li style="<?php echo $width; ?>">
                                        <label title="<?php echo $AnswerVal; ?>" class="checkbox" for="answer_check_<?php echo $quesVal['id'] . '_' . $AnswerKey; ?>" >
                                            <input onclick="<?php  if($quesVal['id'] == 1783){?>
                                            uncheckCheckbox('<?php echo $AnswerVal; ?>');<?php } ?>                                          
                                            <?php
                                            if ($quesVal['depend']) {
                                                if (in_array($AnswerVal, $quesVal['depend']))
                                                    echo "if($('#answer_check_" . $quesVal['id'] . '_' . $AnswerKey . "').attr('checked')) { showDependent('depend_" . $quesVal['id'] . "','" . $AnswerVal . "'); } else { hideDependent('depend_" . $quesVal['id'] . "','" . $AnswerVal . "'); }";
                                            }?>ajaxSave('answer_check_<?php echo $quesVal['id']; ?>[]');" type="checkbox" class="showSingleRadio " name="answer_check_<?php echo $quesVal['id']; ?>[]" id="answer_check_<?php echo $quesVal['id'] . '_' . $AnswerKey; ?>" value="<?php echo $AnswerVal; ?>" <?php
                                            if (in_array($AnswerVal, $patientAnswerArr)) {
                                                echo 'checked="checked"';
                                            }?> 
                                            <?php echo $optional; ?>  <?php echo $tabindex . " " . $autofocus; ?>><?php echo $AnswerVal; ?>
                                        </label>
                                    </li>
                                    <?php }?>
                                </ul>
                            </div>
                        </div>
                    </li>
                    <?php }
                    break;
                case 'text':
                case 'name':
    
                     if($value['practice_id'] == 1223 || $value['practice_id'] == 1211)
                    {
                       $quesVal['question_text'] = str_replace("###PRACTICE_NAME###", "OpenDoctors", $quesVal['question_text']);

                    }
                    else if($value['practice_id'] == 1299 )
                    {
                       $quesVal['question_text'] = str_replace("###PRACTICE_NAME###", $practiceData['practice_name'], $quesVal['question_text']);

                    }

                    if( in_array($quesVal['id'], array('1190')) ){
                        // "PATIENTS_NAME" is inserted as constatnt in databse
                        $patient_name = strtoupper($_SESSION['patient']['lastName']).", ".$_SESSION['patient']['firstName'] ;
                        $quesVal['question_text'] = str_replace("###PATIENTS_NAME###", $patient_name, $quesVal['question_text']);
                        //Enhancement - #23260
                        foreach($this->formDetails as $formForPractice){
                            $apptForPracticeId = $formForPractice['practice_id'];
                        }
                        if($apptForPracticeId == 1246){
                            $pdfPath = "/userData/patientForms/downloads/Notice_of_Privacy_Practices_HI_11292017.pdf";
                        }else{
                            $pdfPath = "/userData/patientForms/downloads/Notice_of_Privacy_Practices_ER_11292017.pdf";
                        }
                        unset($apptForPracticeId);
                        $quesVal['question_text'] = $quesVal['question_text']. "<br><a target='_blank' href='".$pdfPath."'><u>".HERE."</u></a></p>";
                    }
                    $fieldType = explode('|', $quesVal['type']);
                    $fieldCount = count($fieldType);
                    $validation = "";
                    if ($fieldType[1] == 'mm/dd/yyyy' || $quesVal['validate_class'] == 'dob') {
                        $validation = 'onkeypress="ValidateMe(this,\'NumberOnly\',10,\'##/##/####\',event)"';
                        $subClass = 'questionerList_liThirdBorder';
                    }
                    
                    if ($quesVal['validate_class'] == 'name') {
                        $validation = 'onkeypress="ValidateMe(this,\'Names\',10,\'\',event)"';
                    }
                    if ($quesVal['validate_class'] == 'age') {
                        $validation = 'maxlength="3" onkeypress="ValidateMe(this,\'Weight\',3,\'\',event)"';
                    }
					
                    if ($fieldType['1'] == 'CharOnly') {
                        $validation = 'onkeypress="ValidateMe(this,\'Names\',\'\',\'\',event)"';
                    }
                    
                    if ($fieldType['1'] == 'number') {
                        $validation = 'onkeypress="ValidateMe(this,\'Numbers\',\'\',\'\',event)"';
                    }
			
                    if ($key == '87') {
                        $float = '';
                        if ($quesVal['id'] == '448') {
                            $float = ';float:left;';
                        }
                    }
                        $paddingleft= '';
                    if ($quesVal['width'] <= '34') {
                        $float = ';float:left;';
                         $paddingleft = ';padding-left:15px;';
                    }

                    if($fieldType[1] !='techquestions'){
                    ?>
                    <li class="listbox" <?php echo $parentAnswer; ?> validClass="<?php echo $quesVal['validate_class']; ?>" errorlabel="<?php echo $quesVal['error_label']; ?>" style="width:<?php echo $quesVal['width'] . '%'; echo $float;?>;display:<?php echo $quesVal['display'] ?>" <?php
                        if ($quesVal['parent_ques_id']) {
                            echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'";
                        }
                        ?>>
                        <div class="row <?php echo $subClass; ?>" style="<?php echo $paddingleft; ?>">
                            <?php
                            $ansText = '';
                            if ($fieldType[1] == 'ReferringProvider') {
                                //$ansText = '<b>' . $this->apptDetails['referring_name'] . '</b>';
                                $ansText = ($this->apptDetails['referring_name'])?'<b>'.$this->apptDetails['referring_name'].'</b>':"-N/A-";
                            }
                            
                            if ($fieldType[1] == 'ShowAge') {
                                
                                $today = date("Y-m-d");
                                $diff = date_diff(date_create($this->apptDetails['dob']), date_create($today));
                                $age = $diff->format('%y Years');
                                
                                $ansText = ($age)?'<b>'.$age.'</b>':"-N/A-";
                            }
                            
                            if ($fieldType[1] == 'gender') {
                                $ansText = ($this->apptDetails['gender'])?'<b>'.$this->apptDetails['gender'].'</b>':"-N/A-";
                            }
                            
                            if ($quesVal['width'] != '100') {
                                echo '<div class="questionTxt inline padding-left-15">'.$mandatory.''.$quesVal['question_text'].'</div>';
                            }
                           
                           else if ($quesVal['width'] == '100') {
                                echo '<div class="questionTxt col-lg-9 col-md-9 col-sm-12 col-xs-12' . $cclistClassForquestion . '">'.$mandatory.''.$quesVal['question_text'] .' '. $ansText . '</div>';
                            }
                           
                            
                            if ($quesVal['has_dependent_form'] == '1') { ?>
                                    <input type="hidden" name="has_dependent_form_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['has_dependent_form']; ?>">
                            <?php 
                            }

                            if (in_array($fieldType[1], array('surgical_date', 'medication_list', 'doctor_details','Currently_taking','Currently_taking_dose', 'surgical_biospy_date','facility_details', 'blood_pressure_dose'))) {
                                echo '<div class="ajaxDropdownSurgery col-lg-3 col-md-3 col-sm-12 col-xs-12 mob-margin-top-15" style="'.(in_array($fieldType[1], array('doctor_details', 'facility_details') ) ? 'width:100%' : '').'">';
                            } elseif ($fieldType[1] == 'cclist') {
                                echo '<div class="ajaxDropdown col-lg-3 col-md-3 col-sm-12 col-xs-12 mob-margin-top-15">';
                            } elseif ($quesVal['width'] == '100') {
                                echo '<div class="otherTxtHolder col-lg-3 col-md-3 col-sm-12 col-xs-12 mob-margin-top-15">';
                            }
                            if($fieldType[1]=='Email'){
                                $quesVal['patient_answers'] = $_SESSION['patient']['userName'];
                            }
                            $unit = "";
                            if ($fieldType[1] == 'Unit' || $quesVal['validate_class'] == 'weight') {
                                $unit = $fieldType[2];
                                $width = "width: 60px;";
                                $maxLength = "maxlength='5'";
                                $validation = 'onkeypress="ValidateMe(this,\'WeightWithOneDecimal\',5,\'\',event);"';
                                
                            } elseif ($fieldType[1] == 'mm/dd/yyyy' || $quesVal['validate_class'] == 'dob') {
                                $maxLength = "maxlength='10'";
                            } elseif ($fieldType[1] == 'ShowAgeYear' || $quesVal['validate_class'] == 'age') {
                                $unit = $fieldType[2];
                                $fieldType[1] = '';
                                $maxLength = "maxlength='3'";
                                $validation = 'onkeypress="ValidateMe(this,\'Numbers\',3,\'\',event);"';
                            } else {
                                $width = "width:100px;";
                                $unit = "";
                                if($quesVal['field_length'] >= '1') {
                                $maxLength = "maxlength='".$quesVal['field_length']."'";
                                } else {
                                    $maxLength = "maxlength='24'";
                                }
                                //$validation = '';
                                if($fieldType[1] == 'mm-yyyy'){
                                 $validation = 'onkeypress="ValidateMe(this,\'NumberOnly\',7,\'##-####\',event)"';
                                 $optional .= 'class = "monthYearValid"';
                                }
                                if($fieldType[2] == 'PreFix'){
                                    $prefixVal = $fieldType[3].":";
                                }
                            }
                          
                            $cclistClassForquestion = '';

                            $ansText = '';
                            if ($fieldType[1] == 'ReferringProvider' || $fieldType[1] == 'ShowAge' || $fieldType[1] == 'gender') {
                                //$ansText = '<b>' . $this->apptDetails['referring_name'] . '</b>';
                               // $ansText = ($this->apptDetails['referring_name'])?'<b>'.$this->apptDetails['referring_name'].'</b>':"-N/A-";
                            }
                            elseif ($fieldType[1] == 'surgical_date') {// to check cclist .To show referring provider autosuggest box for referring providers

                                $answers = explode('|', $quesVal['patient_answers']);

                                $width = "width:100px;";
                                $cclistClassForquestion = "ajaxQuestion";
                                //for($element = 1; $element <= 1 ; $element++)
                                $element = 1; 
                                $dateIdPrefix = 'surgery_date_'.$element;
                                $yearIdPrefix = 'surgery_year_'.$element;
                                $surgIdPrefix = 'surgery_type_'.$element;
                                $removePrefix = 'surgeryRemoveProvider';
                                $optionaltypeoftest = 'optional="true"';
                                $optionallocation = 'optional="true"';
                                $optionalsurgerytype = 'optional="true"';
                                {
                                    $question++;
                                    $tabindex = 'tabindex="' . $question . '"';
                                    if ($element == 1) {
                                        $cclistShow = '';

                                        if(isset($fieldType[4]) && strtolower($fieldType[4]) == "location")
                                        {
                                            $dateIdPrefix = 'surgery_date_loc_'.$element;
                                            $yearIdPrefix = 'surgery_year_loc_'.$element;
                                            $surgIdPrefix = 'surgery_type_loc_'.$element;
                                            $removePrefix = 'surgeryRemoveProvider_loc';
                                             if(isset($fieldType[3]) && strtolower($fieldType[3]) == "type of test"){ 
                                               $opStr = '<a id="surgeryAddProvider" class="addRemoveIcon addsurgeryCla" onclick="add_surgery_loc_n_typetest(\'' . $quesVal['id'] . '\',this)" customstr="'.$fieldType[4].'">Add More</a>';   
                                              } else {
                                               $opStr = '<a id="surgeryAddProvider" class="addRemoveIcon addsurgeryCla" onclick="add_surgery_loc(\'' . $quesVal['id'] . '\',this)" customstr="'.$fieldType[4].'">Add More</a>';
                                             }
                                         }else
                                        {
                                            $opStr = '<a id="surgeryAddProvider" class="addRemoveIcon addsurgeryCla" onclick="add_surgery(\'' . $quesVal['id'] . '\',this)" customstr="'.$fieldType[3].'">Add More</a>';
                                        }
                                    } else {
                                        //$cclistShow = '';
                                        $cclistShow = 'display:none;';
                                        $optional = 'optional="true"';

                                        $opStr = '<a id="'.$removePrefix.'" class="addRemoveIcon" style="display:none;">Remove</a>';
                                    }?>
                                    <div class="innerDivA <?php echo (isset($fieldType[4]) && strtolower($fieldType[4]) == "location" ? "locExist" : "locNoExist");?>">

                                    <!-- MURTAZA MZ STARTS -->


                                    <select style="" class="select-one form-control" onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" 
                                    answer_type="surgery_date_<?php echo $element; ?>" id="<?php echo $dateIdPrefix;?>"
                                    name="answer_text_<?php echo $quesVal['id']; ?>[]"  <?php echo $optional ?> 
                                    value="<?php echo $answers[($element)]; ?>" class="surgicalDateValid">
                                      <option value="">Month</option>  
                                    <?php
                                        $monthsArray = ['Month','Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
                                        for ($i = 1; $i <= 12; $i++) {
                                            $selected = "";
                                            if ($i == $answers[($element - 1)]) {
                                                $selected = "SELECTED";
                                            }
                                            ?>
                                            <option value="<?php echo $i; ?>" <?php echo $selected; ?>> <?php echo $monthsArray[$i]; ?> </option>
                                            <?php
                                        }
                                    ?>
                                    </select>

                                    <select style="" class="select-one form-control" onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" 
                                    answer_type="surgery_year_<?php echo $element; ?>" id="<?php echo $yearIdPrefix;?>"
                                    name="answer_text_<?php echo $quesVal['id']; ?>[]" <?php echo $optional ?> 
                                    value="<?php echo $answers[($element)]; ?>" class="surgicalDateValid">
                                    <option value="">Year</option> 
                                    <?php
                                    $start = date('Y');
                                    $end = (date('Y') - 19);
                                    for ($j = $start; $j >= $end; $j--) {
                                        $selected = "";
                                        if ($j == $answers[($element)]) {
                                            $selected = "SELECTED";
                                        }
                                        ?>
                                        <option value="<?php echo $j; ?>" <?php echo $selected; ?>> <?php echo $j; ?> </option>
                                        <?php
                                    }
                                    ?>
                                </select>

                                    <!-- MURTAZA MZ ENDS -->

                                    <input onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" 
                                            <?php echo $optionalsurgerytype; ?> answer_type="surgery_type_<?php echo $element; ?>" style="<?php echo $cclistShow; ?>"  
                                            type="text"  placeholder="<?php echo $fieldType[3];?>" 
                                        id="<?php echo $surgIdPrefix; ?>" name="answer_text_<?php echo $quesVal['id']; ?>[]" class="surgeryInput" 
                                        <?php echo $customOptional . " " . $validation; ?> value="<?php echo $answers[2]; ?>" />

                                        <?php if(isset($fieldType[4]) && strtolower($fieldType[4]) == 'location') {?>
                                            <input onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" <?php echo $optionallocation; ?> answer_type="surgery_type_<?php echo $element; ?>" 
                                                style="<?php echo $cclistShow; ?>"  type="text"  placeholder="<?php echo $fieldType[4];?>" id="surgery_loc_<?php echo $element; ?>" name="answer_text_<?php echo $quesVal['id']; ?>[]" 
                                            class="surgeryInput" <?php echo $customOptional . " " . $validation; ?> value="<?php echo $answers[3]; ?>" />
                                        <?php }
                                        echo $opStr;?>
                                    </div>
                                    <?php
                                    #code to check surgery type functionality - start
                                    $limit = (isset($fieldType[4]) ? 4 : 3);
                                    if (count($answers) > $limit) {
                                        $typeCount = 2;
                                        for ($i = $limit; $i < count($answers); $i = $i + $limit) {
                                            $z = $i + 1;
                                            ?>

                                                <script type="text/javascript">
                                                    var objc = $('.locNoExist:last .addRemoveIcon');

                                                    <?php
                                                    if(isset($fieldType[4]) && strtolower($fieldType[4]) == 'location'){?>
                                                        objc = $('.locExist:last .addRemoveIcon');
                                                    <?php }?>


                                                    <?php if(isset($fieldType[4]) && strtolower($fieldType[4]) == 'location'){
                                                         if(isset($fieldType[3]) && strtolower($fieldType[3]) == "type of test"){ ?>
                                                             add_surgery_loc_n_typetest("<?php echo $quesVal['id']; ?>",objc);
                                                         <?php } else { ?>
                                                              add_surgery_loc("<?php echo $quesVal['id']; ?>",objc);
                                                        <?php  } ?>

                                                        $(document).ready(function(){
                                                            $('#surgery_date_loc_<?php echo $typeCount; ?>').val('<?php echo $answers[$i]; ?>');
                                                            $('#surgery_year_loc_<?php echo $typeCount; ?>').val('<?php echo $answers[$z]; ?>');
                                                            $('#surgery_type_loc_<?php echo $typeCount; ?>').val('<?php echo $answers[$i + 2]; ?>');
                                                            $('#surgery_loc_<?php echo $typeCount; ?>').val('<?php echo $answers[$i+3]; ?>');
                                                        });
                                                    <?php
                                                    }else{?>

                                                        add_surgery("<?php echo $quesVal['id']; ?>",objc);
                                                        $(document).ready(function(){
                                                            $('#surgery_date_<?php echo $typeCount; ?>').val('<?php echo $answers[$i]; ?>');
                                                            $('#surgery_year_<?php echo $typeCount; ?>').val('<?php echo $answers[$z]; ?>');
                                                            $('#surgery_type_<?php echo $typeCount; ?>').val('<?php echo $answers[$z+1]; ?>');
                                                        });
                                                    <?php }?>
                                                </script>
                                            <?php
                                            $typeCount++;
                                        }
                                    }
                                    #code to check surgery type functionality - start
                                }                    
                                ?><!--<div class="innerDivA"><input type="text" name="surgeries[]" placeholder="Surgery Type" id="surgeries_1" optional="false" /><input type="text" name="surgery_date[]" placeholder="Surgery Date" id="surgery_date_1" optional="false" /></div>--><?php
                            } 
                            elseif (in_array($fieldType[1], array('medication_list','blood_pressure_dose', 'doctor_details','facility_details'))) {// to check cclist .To show referring provider autosuggest box for referring providers
                                $answers = explode('|', $quesVal['patient_answers']);
                                $width = "width:100px;";
                                $cclistClassForquestion = "ajaxQuestion";
                                //for($element = 1; $element <= 1 ; $element++)
                                if(in_array($fieldType[1], array('medication_list','blood_pressure_dose'))) {
                                    $maxlength = '50';
                                    if($fieldType[1] == 'blood_pressure_dose')
                                    {
                                        $maxlength = '25';
                                    }
                                    $element = 1; 
                                    $question++;
                                    $tabindex = 'tabindex="' . $question . '"';

                                    if ($element == 1) {
                                        $cclistShow = '';
                                        //$opStr = '<img src="/images/addIcon.png" id="surgeryAddProvider" class="addRemoveIcon" onclick="add_surgery(\''.$quesVal['id'].'\',this)"  />';
                                        $opStr = '<a id="addmedicationList" class="addRemoveIcon addsurgeryCla" onclick="add_medication_list(\'' . $quesVal['id'] . '\',this)" >Add More</a>';
                                    } else {
                                        //$cclistShow = '';
                                        $cclistShow = 'display:none;';
                                        $optional = 'optional="true"';
                                        //$opStr = '<img src="/images/removeIcon.png" id="surgeryRemoveProvider" class="addRemoveIcon" style="display:none;"  />';
                                        $opStr = '<a id="removemedicationList" class="addRemoveIcon" style="display:none;">Remove</a>';
                                    }
                                    ?><div class="innerDivB"><input onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" <?php echo $optional; ?> answer_type="medication_<?php echo $quesVal['id'].'_'.$element; ?>" style="<?php echo $cclistShow; ?>"  type="text"  placeholder="Medication" id="medication_<?php echo $quesVal['id'].'_'.$element; ?>" name="answer_text_<?php echo $quesVal['id']; ?>[]" class="" <?php echo $customOptional . " " . $validation; ?> value="<?php echo $answers[0]; ?>" maxlength="<?php echo $maxlength;?>"/>
                                    <input maxlength="<?php echo $maxlength;?>" <?php echo $optional; ?> onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');"  answer_type="dosage_<?php echo $element; ?>"  type="text" placeholder="Dosage" id="dosage_<?php echo $element; ?>" name="answer_text_<?php echo $quesVal['id']; ?>[]" <?php echo $customOptional . " " . $validation; ?> value="<?php echo $answers[1]; ?>" /><?php echo $opStr; ?></div>
                                    <?php
                                    #code to check surgery type functionality - start
                                    if (count($answers) > 2) {
                                        $typeCount = 2;
                                        for ($i = 2; $i < count($answers); $i = $i + 2) {
                                            $z = $i + 1;
                                    ?>

                                        <script type="text/javascript">

                                        var objc = $('.innerDivB:last .addRemoveIcon');
                                        add_medication_list("<?php echo $quesVal['id']; ?>",objc);
                                        $(document).ready(function(){

                                            $('#medication_<?php echo $quesVal['id'].'_'.$typeCount; ?>').val('<?php echo $answers[$i]; ?>');
                                            $('#dosage_<?php echo $quesVal['id'].'_'.$typeCount; ?>').val('<?php echo $answers[$z]; ?>');
                                        });
                                     </script>
                                            <?php
                                            $typeCount++;
                                        }
                                    }
                                    #code to check surgery type functionality - start
                                }

                                if($fieldType[1] == 'doctor_details' || $fieldType[1] == 'facility_details')
                                {
                                    $entityType = explode("_", $fieldType[1]);
                                    
                                    $question++;
                                    $tabindex   = 'tabindex="' . $question . '"';
                                    $questArr   = explode('|', $quesVal['question_answers']);?>

                                     <div class="innerDivB" id="<?php echo $entityType[0];?>_details">
                                        <div class="doctordetails innerDivB">
                                            <table width="100%" style="border:none">
                                            <?php $i = 0;
                                            foreach($questArr as $key4 => $ques)
                                            {
                                                if($i % 2 == 0 || $i == 0) 
                                                {
                                                    echo "<tr>";
                                                    $style = '';
                                                }
                                               
                                                $event = '';
						$optional = 'optional="true"';
                            if(strtolower($ques) == 'name' && $fieldType[1] == 'doctor_details'){
                                $event = 'onkeypress="ValidateMe(this,\'Names\',50,\'\',event)"  maxlength="50"';
                                $optional = 'optional="false"';
    						} else if(strtolower($ques) == 'phone'){
                                $event = 'onkeypress="ValidateMe(this,\'NumberOnly\',12,\'###-###-####\',event)" maxlength="12"';
                            } else if(strtolower($ques) == 'zip'){
                                $event = 'onkeypress="ValidateMe(this,\'NumberOnly\',10,\'#####-#####\',event)" maxlength="10"';
                            } else if (strtolower($ques) == 'address'){
                                $event = 'maxlength="50"';
                            } else{
                                $event = 'maxlength="25"';
                            }

                            echo "<td style=".$style.">".ucfirst($entityType[0])." ".$ques."</td><td>";?>
                            <input onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" <?php echo $optional; ?> 
                            answer_type="<?php echo $entityType[0];?>Details_<?php echo $key4.'_1'; ?>" type="text" 
                            placeholder="<?php echo ucfirst($entityType[0]);?> <?php echo $ques;?>" id="<?php echo $entityType[0];?>Details_<?php echo $key4.'_1'; ?>" 
                            name="answer_text_<?php echo $quesVal['id']; ?>[]" 
                            class="" <?php echo $customOptional . " " . $validation; ?> 
                            value="<?php echo $answers[$key4]; ?>" <?php echo $event;?>/></td>

                                                <?php
                                                if($i % 2 != 0 ) 
                                                {
                                                    echo "</tr>";                                        
                                                }
                                                $i++;
                                            }?>
                                            </table>
                                            <?php if($fieldType[1] == 'doctor_details') {?>
                                            <a id="addDoctorDetails" class="addRemoveIcon addsurgeryCla addmore_link" onclick="add_doctor_details('<?php echo $quesVal['id']?>',this)" ><i class="fa fa-plus-circle fa-2x"></i> Add More</a>
                                            <?php }?>
                                        </div>
                                    </div>
                                    <?php
                                    #code to check surgery type functionality - start
                                    if (count($answers) > 6 && $fieldType[1] == 'doctor_details') {
                                        for ($i = 1; $i < count($answers) / 6; $i++) {
                                            ?>
                                            <script type="text/javascript">
                                                var objc = $('.doctordetails:last .addRemoveIcon');
                                                add_doctor_details("<?php echo $quesVal['id']; ?>",objc);
                                           </script>
                                            <?php
                                        }
                                        $typeCount  = 2;
                                        $j          = 0;
                                        for($k = 6; $k < count($answers); $k++) {
                                            ?>
                                            <script>
                                            $(document).ready(function(){
                                                $('#doctorDetails_<?php echo $j.'_'.$typeCount; ?>').val('<?php echo $answers[$k]; ?>');
                                            });
                                            </script>
                                            <?php
                                            $j++;
                                            if($j % 6 == 0)
                                            {
                                                $j = 0;
                                                $typeCount++;
                                            }
                                        }
                                    }
                                }?>
                            <!--<div class="innerDivA"><input type="text" name="surgeries[]" placeholder="Surgery Type" id="surgeries_1" optional="false" /><input type="text" name="surgery_date[]" placeholder="Surgery Date" id="surgery_date_1" optional="false" /></div>-->
                            <?php
                            }
                            elseif ($fieldType[1] == 'Currently_taking') {
                                $answers = explode('|', $quesVal['patient_answers']);
                                $width = "width:100px;";
                                $cclistClassForquestion = "ajaxQuestion";
                                $element = 1;
                                $question++;
                                $tabindex = 'tabindex="' . $question . '"';
                                if ($element == 1) {
                                    $cclistShow = '';
                                    $opStr = '<a id="addmedicationList" class="addRemoveIcon addsurgeryCla" onclick="addcurrenttaking(\'' . $quesVal['id'] . '\',this)" >Add More</a>';
                                } else {
                                    $cclistShow = 'display:none;';
                                    $optional = 'optional="true"';
                                    $opStr = '<a id="removemedicationList" class="addRemoveIcon" style="display:none;">Remove</a>';
                                }
                                            ?>
                                <div class="innerDivB">
                                    <input onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" <?php echo $optional; ?> answer_type="<?php echo $id."_".$element; ?>" style="<?php echo $cclistShow; ?>"  type="text"  placeholder="Name of Medication" id="<?php echo $id."_".$element; ?>" name="answer_text_<?php echo $quesVal['id']; ?>[]" class="" <?php echo $customOptional . " " . $validation; ?> value="<?php echo $answers[0]; ?>" maxlength="25"/>
                                    <input onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" <?php echo $optional; ?> answer_type="dosage_<?php echo $element; ?>"  type="text" placeholder="Dose" id="dosage_<?php echo $element; ?>" name="answer_text_<?php echo $quesVal['id']; ?>[]" <?php echo $customOptional . " " . $validation; ?> value="<?php echo $answers[1]; ?>" maxlength="25"/>
                                    <input onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" <?php echo $optional; ?> answer_type="provider_<?php echo $element; ?>"  type="text" style="width:180px;" placeholder="Name of Ordering Provider" id="provider_<?php echo $element; ?>" name="answer_text_<?php echo $quesVal['id']; ?>[]" <?php echo $customOptional . " " . $validation; ?> value="<?php echo $answers[2]; ?>" maxlength="25"/>
                                    <input onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" <?php echo $optional; ?> answer_type="pharmacy_<?php echo $element; ?>"  type="text" style="width:160px;" placeholder="Name of Pharmacy" id="pharmacy_<?php echo $element; ?>" name="answer_text_<?php echo $quesVal['id']; ?>[]" <?php echo $customOptional . " " . $validation; ?> value="<?php echo $answers[3]; ?>" maxlength="25"/>
                                    <?php echo $opStr; ?>

                                </div>
                                <?php
                                #code to check surgery type functionality - start
                                if (count($answers) > 4) {
                                    $typeCount = 2;
                                    for ($i = 4; $i < count($answers); $i = $i + 4) { 
                                ?>

                                            <script type="text/javascript">

                                                var objc = $('.innerDivB:last .addRemoveIcon');
                                                addcurrenttaking("<?php echo $quesVal['id']; ?>", objc); 
                                                $(document).ready(function() {
                                                    $('#<?php echo $id."_".$typeCount; ?>').val('<?php echo $answers[$i]; ?>');
                                                    $('#dosage_<?php echo $typeCount; ?>').val('<?php echo $answers[$i + 1]; ?>');
                                                    $('#provider_<?php echo $typeCount; ?>').val('<?php echo $answers[$i + 2]; ?>');
                                                    $('#pharmacy_<?php echo $typeCount; ?>').val('<?php echo $answers[$i + 3]; ?>');

                                                });
                                         </script>
                                        <?php
                                        $typeCount++;
                                    }
                                   }//EO count


                                #code to check surgery type functionality - start
                                        ?><!--<div class="innerDivA"><input type="text" name="surgeries[]" placeholder="Surgery Type" id="surgeries_1" optional="false" /><input type="text" name="surgery_date[]" placeholder="Surgery Date" id="surgery_date_1" optional="false" /></div>--><?php
                            } 
                            elseif ($fieldType[1] == 'Currently_taking_dose') {
                                $answers = explode('|', $quesVal['patient_answers']);
                                $width = "width:100px;";
                                $cclistClassForquestion = "ajaxQuestion";
                                $element = 1;
                                $question++;
                                $tabindex = 'tabindex="' . $question . '"';
                                $optionalDose = 'optional="true"';
                                if ($element == 1) {
                                    $cclistShow = '';
                                    $opStr = '<a id="addmedicationList" class="addRemoveIcon addsurgeryCla" onclick="addcurrenttakingdose(\'' . $quesVal['id'] . '\',this)" >Add More</a>';
                                } else {
                                    $cclistShow = 'display:none;';
                                    $optional = 'optional="true"';
                                    $opStr = '<a id="removemedicationList" class="addRemoveIcon" style="display:none;">Remove</a>';
                                }
                                            ?>
                                 <div class="innerDivB">
                                    <input onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" <?php echo $optional; ?> answer_type="<?php echo $id."_".$element; ?>" style="<?php echo $cclistShow; ?>"  type="text"  placeholder="Name of Medication" id="<?php echo $id."_".$element; ?>" name="answer_text_<?php echo $quesVal['id']; ?>[]" class="" <?php echo $customOptional . " " . $validation; ?> value="<?php echo $answers[0]; ?>" maxlength="25"/>
                                    <input onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" <?php echo $optionalDose; ?> answer_type="dosage_<?php echo $element; ?>"  type="text" placeholder="Dose" id="dosage_<?php echo $element; ?>" name="answer_text_<?php echo $quesVal['id']; ?>[]" <?php echo $customOptional . " " . $validation; ?> value="<?php echo $answers[1]; ?>" maxlength="25"/>
                                    <?php echo $opStr; ?>
                                </div>
                                <?php

                                #code to check surgery type functionality - start
                                 if (count($answers) > 2) {
                                    $typeCount = 2;
                                    for ($i = 2; $i < count($answers); $i = $i + 2) { 
                                ?>

                                    <script type="text/javascript">

                                        var objc = $('.innerDivB:last .addRemoveIcon');
                                        addcurrenttakingdose("<?php echo $quesVal['id']; ?>", objc); 
                                        $(document).ready(function() {

                                            $('#<?php echo $id."_".$typeCount; ?>').val('<?php echo $answers[$i]; ?>');
                                            $('#dosage_<?php echo $typeCount; ?>').val('<?php echo $answers[$i + 1]; ?>');


                                        });
                                 </script>
                                        <?php
                                        $typeCount++;
                                    }
                                   }//EO count


                                #code to check surgery type functionality - start
                                        ?><!--<div class="innerDivA"><input type="text" name="surgeries[]" placeholder="Surgery Type" id="surgeries_1" optional="false" /><input type="text" name="surgery_date[]" placeholder="Surgery Date" id="surgery_date_1" optional="false" /></div>--><?php
                            } 
                            elseif ($fieldType[1] == 'surgical_biospy_date') {
                                $answers = explode('|', $quesVal['patient_answers']);
                                $width = "width:100px;";
                                $cclistClassForquestion = "ajaxQuestion";
                                $element = 1;
                                $question++;
                                $tabindex = 'tabindex="' . $question . '"';
                                if ($element == 1) {
                                    $cclistShow = '';
                                    $opStr = '<a id="addmedicationList" class="addRemoveIcon addsurgeryCla" onclick="addsurgicalbiospy(\'' . $quesVal['id'] . '\',this)" >Add More</a>';
                                } else {
                                    $cclistShow = 'display:none;';
                                    $optional = 'optional="true"';
                                    $opStr = '<a id="removemedicationList" class="addRemoveIcon" style="display:none;">Remove</a>';
                                }
                                        ?>
                                                                <div class="innerDivB">
                                                                    <input onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" <?php echo $optional; ?> answer_type="surgicalbiospy_<?php echo $element; ?>" style="<?php echo $cclistShow; ?>"  type="text"  placeholder="Type of Surgery or Biopsy" id="surgicalbiospy_<?php echo $element; ?>" name="answer_text_<?php echo $quesVal['id']; ?>[]" class="" <?php echo $customOptional . " " . $validation; ?> value="<?php echo $answers[0]; ?>" maxlength="25"/>
                                                                    <input maxlength="10" onkeypress="ValidateMe(this, 'NumberOnly', 10, '##/##/####', event)" <?php echo $optional; ?> onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');"  answer_type="surgicalbiospy_date_<?php echo $element; ?>" style="<?php echo $cclistShow; ?>"  type="text" placeholder="mm/dd/yyyy" id="surgicalbiospy_date_<?php echo $element; ?>" name="answer_text_<?php echo $quesVal['id']; ?>[]" <?php echo $customOptional ?> value="<?php echo $answers[1]; ?>" />
                                                                    <input onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" <?php echo $optional; ?> answer_type="surgicalbiospy_provider_<?php echo $element; ?>"  type="text" placeholder="Name of Surgeon" id="surgicalbiospy_provider_<?php echo $element; ?>" name="answer_text_<?php echo $quesVal['id']; ?>[]" <?php echo $customOptional . " " . $validation; ?> value="<?php echo $answers[2]; ?>" maxlength="25"/>
                                <?php echo $opStr; ?>
                                                                </div>
                                <?php
                                #code to check surgery type functionality - start
                                if (count($answers) > 3) {
                                    $typeCount = 2;
                                    for ($i = 3; $i < count($answers); $i = $i + 3) {
                                ?>

                                                                                <script type="text/javascript">

                                                                                    var objc = $('.innerDivB:last .addRemoveIcon');
                                                                                    addsurgicalbiospy("<?php echo $quesVal['id']; ?>", objc);
                                                                                    $(document).ready(function() {

                                                                                        $('#surgicalbiospy_<?php echo $typeCount; ?>').val('<?php echo $answers[$i]; ?>');
                                                                                        $('#surgicalbiospy_date_<?php echo $typeCount; ?>').val('<?php echo $answers[$i + 1]; ?>');
                                                                                        $('#surgicalbiospy_provider_<?php echo $typeCount; ?>').val('<?php echo $answers[$i + 2]; ?>');
                                                                                    });
                                                                             </script>
                                        <?php
                                        $typeCount++;
                                    }
                                }
                                #code to check surgery type functionality - start
                                        ?><!--<div class="innerDivA"><input type="text" name="surgeries[]" placeholder="Surgery Type" id="surgeries_1" optional="false" /><input type="text" name="surgery_date[]" placeholder="Surgery Date" id="surgery_date_1" optional="false" /></div>--><?php
                            } 
                            elseif ($fieldType[1] == 'cclist') { // to check cclist .To show referring provider autosuggest box for referring providers
                                $answers = explode('|', $quesVal['patient_answers']);
                                $width = "width:100px;";
                                $cclistClassForquestion = "ajaxQuestion";
                                for ($element = 1; $element <= 2; $element++) {
                                    $question++;
                                    $tabindex = 'tabindex="' . $question . '"';
                                    if ($element == 1) {
                                        $cclistShow = '';
                                        $opStr = '<img src="/images/addIcon.png" id="addProvider" class="addRemoveIcon"  />';
                                    } else {
                                        $cclistShow = 'display:none;';
                                        $optional = 'optional="true"';
                                        $opStr = '<img src="/images/removeIcon.png" id="removeProvider" class="addRemoveIcon" style="display:none;"  />';
                                    }?>
                                    <div class="innerDivA">
                                        <input  <?php echo $optional; ?> answer_type="cclist_<?php echo $element; ?>" 
                                        style="width:250px; vertical-align: middle; <?php echo $cclistShow; ?>" type="text" 
                                        onblur="cclistblur(this);ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" 
                                        id="answer_text_<?php echo $quesVal['id']; ?>_<?php echo $element; ?>" 
                                        name="answer_text_<?php echo $quesVal['id']; ?>[]" 
                                        value="<?php echo $answers[$element - 1]; ?>" 
                                        <?php echo  $customOptional  . " " .$validation . " " . $maxLength; ?> 
                                        placeholder="Referring Provider" <?php echo $tabindex . " " . $autofocus; ?>> 
                                        <?php echo $opStr; ?>
                                    </div>
                                    <?php
                                }?>
                                <input type="hidden" name="refDocId" id="refDocId" value="<?php echo $this->apptDetails['referring_doctor_id']; ?>">
                                <input type="hidden" name="answer_text_<?php echo $quesVal['id']; ?>[]" id="referring_doc_id_cclist_1" value="<?php echo $answers['2']; ?>" /><?php ?><input type="hidden" name="answer_text_<?php echo $quesVal['id']; ?>[]" id="referring_doc_id_cclist_2" value="<?php echo $answers['3']; ?>" />
                                    <?php
                                }
                            elseif ($fieldType[1] != 'Unit' && $fieldType[1] != '') {
                                
                                $answers = explode('|', $quesVal['patient_answers']);
                                $width = "width:100px;";
                                if( in_array($value['practice_id'], array('1223','1211','1299'))){
                                    $width = "width:100%;";
                                }

                                for ($element = 1; $element < $fieldCount; $element++) {
                                    $question++;
                                    $tabindex = 'tabindex="' . $question . '"';

                                    if ($fieldType[$element] == "Middle Name") {
                                        $customOptional = 'optional="true"';
                                    } else {
                                        $customOptional = $optional;
                                    }
                                    if ($fieldType[$element] != "combinePdfOnly") {
                                    ?>
                                        <input style="<?php echo $width; ?>" type="text" onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" id="answer_text_<?php echo $quesVal['id']; ?>_<?php echo $element; ?>" name="answer_text_<?php echo $quesVal['id']; ?>[]" value="<?php echo $answers[$element - 1]; ?>" <?php echo $customOptional . " " . $validation . " " . $maxLength; ?> placeholder="<?php echo $fieldType[$element]; ?>" <?php echo $tabindex . " " . $autofocus; ?>>
                                    <?php
                                    }
                                }
                            } 
                            else { 
                                $question++;
                                $tabindex = 'tabindex="' . $question . '"';
                                $width = "width:100px;";
                                if( in_array($value['practice_id'], array('1223','1211','1299')) || in_array($quesVal['id'], array('1664','1665','1666','1728')) ){
                                    $width = "width:100%;";
                                }
                             
                                if ($question == 9 && $quesVal['id'] != '923') {
                                    $validation = 'onkeypress="ValidateMe(this,\'Names\',10,\'\',event)"';
                                }
                                if($this->isMobile){
                                    $validation = 'oninput="ValidateMe(this,\'WeightWithOneDecimal\',5,\'\',event);"';
                                }
                                 echo $prefixVal;
                                    ?>
                               <input <?php echo $tabindex . " " . $autofocus; ?> style="<?php echo $width; ?>" type="text" onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>');" id="answer_text_<?php echo $quesVal['id']; ?>" name="answer_text_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['patient_answers']; ?>" <?php echo $optional . " " . $validation . " " . $maxLength; ?>>
                            <?php } ?>
                            <?php echo "&nbsp;" . $unit; ?>
                            <?php
                            if ($quesVal['width'] == '100') {
                                echo '</div>';
                            }
                            ?>
                        </div>
                    </li>
                    <?php }
                break;
                case 'drop-down':
                    $fieldType = explode('|', $quesVal['type']);
                    
                    $fieldCount = count($fieldType);
                     
                                    $float = '';
                                    if($quesVal['width'] <= '34')
                                    {
                                            $float = ';float:left;';
                                    }
                               
                    ?>
                    <li class="listbox" <?php echo $parentAnswer; ?> validClass="<?php echo $quesVal['validate_class']; ?>" errorlabel="<?php echo $quesVal['error_label']; ?>" style="width:<?php echo $quesVal['width'] . '%'; echo $float;?>;display:<?php echo $quesVal['display']; ?>;" <?php
                        if ($quesVal['parent_ques_id']) {echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'";}?>>
                        <div class="row <?php echo ($fieldType[1] == 'question_answer' ? '' : $subClass); ?>">
                            
                            <?php 
                            $respClass = ($quesVal['width'] > '34') ? 'col-lg-9 col-md-9 col-sm-12 col-xs-12' : 'inline padding-left-15';
                            echo '<div class="questionTxt '.$respClass.' ">'.$mandatory.''.$quesVal['question_text'] . '</div>';
                            
                            
                         
                            if($fieldType[1] == 'question_answer'){
                                $tablePatientAnswer = array();
                                if ($quesVal['patient_answers']) {
                                    $tablePatientAnswer = unserialize($quesVal['patient_answers']);
                                    ksort($tablePatientAnswer);
                                }?>
                                <table width="100%" class="formTable" id="table_<?php echo $quesVal['id'];?>">
                                    <tbody>
                                    <tr>
                                        <td class="th" width="45%">Family Member</td>
                                        <td class="th" width="45%">Type of Cancer</td>
                                        <td class="th">&nbsp;</td>
                                    </tr>
                                    <tr id = "tr_1">
                                        <td>
                                            <select class="select-one selectDrop form-control <?php echo $numbercls; ?>" style="width:50%"  onblur="ajaxSave('answer_table_<?php echo $quesVal['id']; ?>','table');" id="answer_text_<?php echo $quesVal['id']; ?>" name="answer_table_<?php echo $quesVal['id']; ?>[]" <?php echo $optional; ?> <?php echo $tabindex . " " . $autofocus; ?> <?php echo $onselect; ?>>
                                                <option value="">Select</option>
                                                <?php
                                                $question_answers = explode("|", $quesVal['question_answers']);
                                                foreach($question_answers as $ques){?>
                                                    <script>familyMembers.push("<?php echo $ques;?>");</script>
                                                    <option value="<?php echo str_replace(" ","_",$ques);?>" <?php echo ($tablePatientAnswer[0] == str_replace(" ","_",$ques) ? 'selected="selected"' : '');?>><?php echo $ques;?></option>
                                                <?php
                                                }?>
                                            </select>
                                        </td>
                                        <td>
                                            <input onblur="ajaxSave('answer_table_<?php echo $quesVal['id']; ?>','table');"type = "text" name="answer_table_<?php echo $quesVal['id']; ?>[]" id="answer_text_<?php echo $quesVal['id']; ?>_1" maxlength="25" value="<?php echo $tablePatientAnswer[1];?>">
                                        </td>
                                        <td>
                                            &nbsp;
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                                <?php
                                if (count($tablePatientAnswer)) {
                                    $typeCount = 2;
                                    for ($i = 2; $i < count($tablePatientAnswer); $i = $i + 1) {
                                    ?>
                                        <script type="text/javascript">
                                            counter = "<?php echo floor(count($tablePatientAnswer) / 2); ?>";
                                            <?php if($i % 2 == 0){?>
                                                add_family_details("<?php echo $quesVal['id']; ?>","<?php echo $typeCount;?>");
                                            <?php
                                            }?>
                                            $(document).ready(function(){
                                                $('#family_select_<?php echo $quesVal['id'].'_'.$typeCount;?>').val('<?php echo $tablePatientAnswer[$i]; ?>');
                                                $('#family_input_<?php echo $quesVal['id'].'_'.$typeCount;?>').val('<?php echo $tablePatientAnswer[$i+1]; ?>');
                                            });
                                        </script>
                                    <?php
                                        if($i % 2 == 0){
                                            $typeCount++;
                                        }
                                    }
                                }
                                ?>
                                <a id="addCancerbackground" class="addRemoveIcon addmore_link" onclick="add_family_details('<?php echo $quesVal['id']?>',++counter);"><i class="fa fa-plus-circle fa-2x"></i> Add More</a>
                            <?php
                            }
                            else
                            {
                                 if($quesVal['width'] > '34'){ ?>
                            <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12 mob-margin-top-15" >
                            <?php
                            }
                            
                                if($key == '87')
                                {
                                    $float = '';
                                    if($quesVal['id'] == '447')
                                    {
                                            $float = ';float:right;';
                                    }
                                }
                               
                                if ($quesVal['has_dependent_form'] == '1') { ?>
                                    <input type="hidden" name="has_dependent_form_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['has_dependent_form']; ?>">
                                    <?php
                                }
                                if ($quesVal['width'] == '100') {
                                    echo '<div class="btnYesNo_depend formSelect">';
                                    for ($element = 1; $element < $fieldCount; $element++) {
                                        if ($fieldType[$element] == 'Month') {
                                            echo '<div class="formSelect2">';
                                        }
                                    }
                                }

                                for ($element = 1; $element < $fieldCount; $element++) {
                                    $question++;
                                    $tabindex = 'tabindex="' . $question . '"';
                                    $preUnit = "";
                                    $unit = "";
                                    $numbercls = '';
                                    if ($fieldType[$element] == 'Feet') {
                                        $start = "0";
                                        $end = "7";
                                        $preUnit = '<option value="" SELECTED>--</option>';
                                        $unit = "ft ";
                                    } elseif ($fieldType[$element] == 'Inches') {
                                        $start = "0";
                                        $end = "11";
                                        $preUnit = '<option value="" SELECTED>--</option>';
                                        $unit = "in ";
                                    } elseif ($fieldType[$element] == 'Month') {
                                        $start = "1";
                                        $end = "12";
                                        $preUnit = '<option value="" SELECTED>Month</option>';
                                        $onselect = 'onchange="checkSelected(\'month\',this.value, \'' . date('n-j-Y') . '\', \'' . $quesVal['id'] . '\');"';
                                        //$preUnit = "<strong>Month: </strong>";
                                    } elseif ($fieldType[$element] == 'Year') {
                                        $start = date('Y');
                                        $end = (date('Y') - 19);
                                        $preUnit = '<option value="" SELECTED>Year</option>';
                                        $onselect = 'onchange="checkSelected(\'year\',this.value, \'' . date('n-j-Y') . '\', \'' . $quesVal['id'] . '\');"';
            //										$onselect = 'onchange="checkSelected(\'year\',this.value, \'8-1-2013\', \'' . $quesVal['id'] . '\');"';
                                    } elseif ($fieldType[$element] == 'MonthCount') {
                                        $start = "0";
                                        $end = "11";
                                        $preUnit = '<option value="" SELECTED>Months</option>';
                                    } elseif ($fieldType[$element] == 'YearCount') {
                                        $start = "0";
                                        $end = "19";
                                        $preUnit = '<option value="" SELECTED>Years</option>';
                                        //$preUnit = "<strong>Year: </strong>";
                                    } elseif ($fieldType[$element] == 'number') {
                                        $startEndArr = explode('|', $quesVal['question_answers']);
                                        $start = $startEndArr[0];
                                        $end = $startEndArr[1];
                                        $preUnit = '<option value="" SELECTED> Select </option>';
                                        //$preUnit = "<strong>Year: </strong>";
                                        $numbercls = "selectDrop";
                                    } elseif ($fieldType[$element] == 'dropAge') {
                                        $startEndArr = explode('|', $quesVal['question_answers']);
                                        $start = $startEndArr[0];
                                        $end = $startEndArr[1];
                                        $preUnit = '<option value="" SELECTED> Select </option>';
                                        $numbercls = "selectDrop";
                                    } elseif ($fieldType[$element] == 'OnDropSelect') {
                                        $startEndArr = explode('|', $quesVal['question_answers']);
                                        $start = $startEndArr[0];
                                        $end = $startEndArr[1];
                                        $preUnit = '<option value="" SELECTED> Select </option>';
                                        $onselect = 'onchange="checkSelected(\'OnDropSelect\',this.value, \'' . date('n-j-Y') . '\', \'' . $quesVal['id'] . '\');"';
                                        $numbercls = "selectDrop";
                                    }elseif($fieldType[$element] == 'DefaultDropDown'){
                                        $startEndArr = explode('|', $quesVal['question_answers']);
                                        $start = $startEndArr[0];
                                        $end = $startEndArr[1];
                                        $preUnit = '<option value="" SELECTED> Select </option>';
                                        $numbercls = "selectDrop";
                                    }
                                    $answers = explode('|', $quesVal['patient_answers']);
                                    ?>
                                    <select style="" class="form-control select-one <?php echo $numbercls; ?>" onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" id="answer_text_<?php echo $quesVal['id'] . "_" . $element; ?>" name="answer_text_<?php echo $quesVal['id']; ?>[]" value="<?php echo $answers[($element - 1)]; ?>" <?php echo $optional; ?> <?php echo $tabindex . " " . $autofocus; ?> <?php echo $onselect; ?>>
                                    <?php
                                    echo $preUnit;

                                    if ($fieldType[$element] == 'Year') {
                                        for ($optionValue = $start; $optionValue >= $end; $optionValue--) {
                                            $selected = "";
                                            if ($optionValue == $answers[($element - 1)]) {
                                                $selected = "SELECTED";
                                            }?><option value="<?php echo $optionValue; ?>" <?php echo $selected; ?>>
                                            <?php
                                            if ($fieldType[$element] == 'Month') {
                                                echo date('M', mktime(0, 0, 0, $optionValue, 1, 0));
                                            } else {
                                                echo $optionValue;
                                            }
                                            ?>
                                        </option>
                                            <?php
                                        }
                                    } else if($fieldType[$element] == 'DefaultDropDown'){
                                        foreach($startEndArr as $ddKey => $ddVal ){
                                            $selected = "";
                                            if ($ddVal == $answers[($element - 1)]) {
                                                $selected = "SELECTED";
                                            } ?><option value="<?php echo $ddVal; ?>" <?php echo $selected; ?>><?php echo $ddVal; ?> </option><?php
                                            
                                        }
                                    } 
                                    else {
                                        for ($optionValue = $start; $optionValue <= $end; $optionValue++) {
                                            $selected = "";
                                            if ($optionValue == $answers[($element - 1)]) {
                                                $selected = "SELECTED";
                                            }
                                            ?>                                                                                              <option value="<?php echo $optionValue; ?>" <?php echo $selected; ?>>
                                            <?php
                                            if ($fieldType[$element] == 'Month') {
                                                echo date('M', mktime(0, 0, 0, $optionValue, 1, 0));
                                            } else {
                                                echo $optionValue;
                                            }
                                            ?>      </option>
                                        <?php
                                        }
                                    }
                                    ?>
                                    </select>
                                    <?php echo $unit; ?>
                                    <?php
                                }

                                if ($quesVal['width'] == '100') {
                                    echo '</div>';
                                    for ($element = 1; $element < $fieldCount; $element++) {
                                        if ($fieldType[$element] == 'Month') {
                                            echo '</div>';
                                        }
                                    }
                                   
                                    
                                }
                            }
                              if($quesVal['width'] > '34'){ ?>
                                </div>
                            <?php
                            } ?>  
                        </div>
                    </li>                                            
                    <?php
                    break;
                case 'phone':
                    $question++;
                    $tabindex = 'tabindex="' . $question . '"';
                    ?>
                    <li class="listbox" <?php echo $parentAnswer; ?> validClass="<?php echo $quesVal['validate_class']; ?>" errorlabel="<?php echo $quesVal['error_label']; ?>" style="width:<?php echo $quesVal['width'] . '%'; ?>;display:<?php echo $quesVal['display']; ?>" <?php
                    if ($quesVal['parent_ques_id']) {
                        echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'";
                    }
                    ?>>
                    <div class="row <?php echo $subClass; ?>">
                    <?php
                    $fieldType = explode('|', $quesVal['type']);
                    
                    if(empty($quesVal['patient_answers']))
                    {
                        if($fieldType[3]=='home'){
                            $quesVal['patient_answers'] = $_SESSION['patient']['phone_number2'];
                        }else if($fieldType[3]=='work'){
                            $quesVal['patient_answers'] = $_SESSION['patient']['phone_number'];
                        }else if($fieldType[3]=='cell'){
                            $quesVal['patient_answers'] = $_SESSION['patient']['cell'];
                        }
                        else if($fieldType[3]=='location'){
                             $provderLoc = new Application_Model_ProviderLocations();
                             $providerLocdata = $provderLoc->fetchLocationDetailsByLocationId($this->apptDetails['provider_location_id']);
                             $quesVal['patient_answers'] = $providerLocdata['phone_number']; 
                        }
                    }
                        
                    if($fieldType[2] == 'Full') {
                       echo '<div class="questionTxt col-lg-9 col-md-9 col-sm-12 col-xs-12">'.$mandatory.''.$quesVal['question_text'].'</div>';
                       echo '<div class="otherTxtHolder col-lg-3 col-md-3 col-sm-12 col-xs-12 mob-margin-top-15">'; 
                       ?>
                              <input type="text" onblur="ajaxSave('answer_phone_<?php echo $quesVal['id']; ?>');" id="answer_phone_<?php echo $quesVal['id']; ?>" name="answer_phone_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['patient_answers']; ?>" <?php echo $optional; ?> maxlength="12" 
                              <?php 
                              
                              if(!$this->isMobile){?>
                                onkeypress="ValidateMe(this, 'Numbers', 12, '###-###-####', event);" 
                             <?php } else { ?>
                                oninput="ValidateMe(this, 'Numbers', 12, '###-###-####', event);" 
                             <?php } ?>
                              <?php echo $tabindex . " " . $autofocus; ?>   style="width:50%;">                          
                       <?php       
                       echo '</div>';                            
                       
                    } else {
                        if ($quesVal['width'] == '30' || $quesVal['width'] == '31') {
                            echo $mandatory.''."<strong>" . $quesVal['question_text'] . "</strong>";
                        } else {  
                            echo $mandatory.''.$quesVal['question_text'];
                        }
                        if ($quesVal['has_dependent_form'] == '1') {?>
                                <input type="hidden" name="has_dependent_form_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['has_dependent_form']; ?>">
                                                            <?php } 
                                                            ?>                                   
                        <input type="text" onblur="ajaxSave('answer_phone_<?php echo $quesVal['id']; ?>');" id="answer_phone_<?php echo $quesVal['id']; ?>" name="answer_phone_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['patient_answers']; ?>" <?php echo $optional; ?> maxlength="12" 
                            <?php  
                            
                            if(!$this->isMobile){?>
                            onkeypress="ValidateMe(this, 'Numbers', 12, '###-###-####', event);" 

                            <?php } else{?>oninput="ValidateMe(this, 'Numbers', 12, '###-###-####', event);" <?php } echo $tabindex . " " . $autofocus; ?>>
                                                        <?php }
                                                        ?>                                      
                        </div>
                    </li>
                    <?php
                    break;
                case 'full-text':                   
                    if($quesVal['id'] == '1881'){
                      //  echo "<pre>";
                      //  print_r($quesVal);
                    }
                    $question++;
                    $tabindex = 'tabindex="' . $question . '"';
                    $fieldType = explode('|', $quesVal['type']);
                    if ($fieldType['1'] == 'AlphaOnly') {
                        $validation = 'onkeypress="ValidateMe(this,\'Signature\',\'\',\'\',event);" onkeyup="ValidateMe(this,\'Signature\',\'\',\'\',event);" onkeydown="ValidateMe(this,\'Signature\',\'\',\'\',event);"';
                    } 
                    else {
                        $validation = "";
                    }
                    if($fieldType[1] != 'techquestions'){

                    ?>
                    <li class="listbox" <?php echo $parentAnswer; ?> validClass="<?php echo $quesVal['validate_class']; ?>" errorlabel="<?php echo $quesVal['error_label']; ?>" style="width:<?php echo $quesVal['width'] . '%'; ?>;display:<?php echo $quesVal['display']; ?>" <?php
                    if ($quesVal['parent_ques_id']) {
                        echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'";
                    }
                    ?>>
                        <div class="row <?php echo $subClass; ?>">
                    <?php if ($quesVal['has_dependent_form'] == '1') { ?>
                        <input type="hidden" name="has_dependent_form_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['has_dependent_form']; ?>">
                    <?php } ?>
                        <?php if($quesVal['optional'] != 1 && !empty($quesVal['question_text']) ){ echo '<div class="questionTxt col-lg-9 col-md-9 col-sm-12 col-xs-12">'.$mandatory.''. $quesVal['question_text'] . '</div>'; }
                            else{ ?>
                                <span class="fieldStarB" style="padding-left: 15px;float: left;line-height: 2px;">*</span>
                               
                         <?php   } 
                        ?>

                        <?php if($quesVal['id'] == '1988') {?>
                            <div class="btnYesNo_depend padBT0 col-lg-3 col-md-3 col-sm-12 col-xs-12 mob-margin-top-15">
                                <input style="width:92%;" type="text" onkeypress="ValidateMe(this,'Numbers',50,'',event)" onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>');" id="answer_text_<?php echo $quesVal['id']; ?>" name="answer_text_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['patient_answers']; ?>" <?php echo $optional; ?> maxlength="35" <?php echo $tabindex . " " . $autofocus . " " . $validation; ?> >
                            </div>
                        <?php }
                        else if($fieldType['1'] == 'Alphanumeric'){ ?>
                             <div class="btnYesNo_depend padBT0 col-lg-3 col-md-3 col-sm-12 col-xs-12 mob-margin-top-15">
                                <input style="width:92%;" type="text" onkeypress="ValidateMe(this,'AlphaNum',50,'',event)" onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>');" id="answer_text_<?php echo $quesVal['id']; ?>" name="answer_text_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['patient_answers']; ?>" <?php echo $optional; ?> maxlength="35" <?php echo $tabindex . " " . $autofocus . " " . $validation; ?> >
                            </div>
                            
                        <?php }
                        
                        else{ ?>
                        <div class="btnYesNo_depend padBT0 col-lg-3 col-md-3 col-sm-12 col-xs-12 mob-margin-top-15" id="anstxtdiv">
                            <input style="width:92%;" type="text" onkeypress="ValidateMe(this,'Names',50,'',event)" onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>');" id="answer_text_<?php echo $quesVal['id']; ?>" name="answer_text_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['patient_answers']; ?>" <?php echo $optional; ?> maxlength="35" <?php echo $tabindex . " " . $autofocus . " " . $validation; ?> >
                        </div>
                        <?php } ?>

                        </div>
                    </li>

                    <?php }
                    break;
                case 'encrypt':

                    $question++;
                    $tabindex = 'tabindex="' . $question . '"';
                    ?>                           
                    <li <?php echo $parentAnswer; ?> validClass="<?php echo $quesVal['validate_class']; ?>" errorlabel="<?php echo $quesVal['error_label']; ?>" style="width:<?php echo $quesVal['width'] . '%'; ?>;display:<?php echo $quesVal['display']; ?>" <?php
                    if ($quesVal['parent_ques_id']) {
                        echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'";
                    }
                    ?>>
                        <div class="<?php echo $subClass; ?>">
                    <?php if ($quesVal['has_dependent_form'] == '1') { ?>
                        <input type="hidden" name="has_dependent_form_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['has_dependent_form']; ?>">
                    <?php }
                    ?>
                        <div class="btnYesNo padBT0">
                        <input style="width:98px;" type="text" onblur="ajaxSave('answer_encrypt_<?php echo $quesVal['id']; ?>');" id="answer_text_<?php echo $quesVal['id']; ?>" name="answer_encrypt_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['patient_answers']; ?>" <?php echo $optional; ?> maxlength=11 onkeypress="ValidateMe(this, 'NumberOnly', 11, '###-##-####', event);" onkeyup="ValidateMe(this, 'NumberOnly', 11, '###-##-####', event);" <?php echo $tabindex . " " . $autofocus; ?>></div>
                        <?php echo '<div class="questionTxt">' .$mandatory.''.$quesVal['question_text'] . '</div>'; ?>
                        </div> 
                    </li>                            
                    <?php
                    break;
                case 'textarea':
                   
                    if ($quesVal['field_length'] != '0') {
                        $maxlength = $quesVal['field_length'];
                    } else {
                        $maxlength = "500";
                    }
                    $question++;
                    $tabindex = 'tabindex="' . $question . '"';
                    $fieldType = explode('|', $quesVal['type']);
                    if($fieldType[1] != 'techquestions'){
                    
                    ?>
                    <li class="listbox" <?php echo $parentAnswer; ?> validClass="<?php echo $quesVal['validate_class']; ?>" errorlabel="<?php echo $quesVal['error_label']; ?>" style="width:<?php echo $quesVal['width'] . '%'; ?>;display:<?php echo $quesVal['display']; ?>" <?php
                    if ($quesVal['parent_ques_id']) {
                        echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'";
                    }
                    ?>>
                        <div class="row <?php echo $subClass; ?>">
                            <div class="questionTxt col-lg-12 col-md-12 col-sm-12 col-xs-12 mb15"><?php echo $mandatory.''.$quesVal['question_text']; ?></div>
                    <?php if ($quesVal['has_dependent_form'] == '1') { ?>
                        <input type="hidden" name="has_dependent_form_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['has_dependent_form']; ?>">
                    <?php }
                    ?>
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <textarea class="form-control" maxlength="<?php echo $maxlength; ?>" onblur="ajaxSave('answer_textarea_<?php echo $quesVal['id']; ?>');" id="answer_textarea_<?php echo $quesVal['id']; ?>" name="answer_textarea_<?php echo $quesVal['id']; ?>"  <?php echo $optional; ?>  <?php echo $tabindex . " " . $autofocus; ?>><?php echo $quesVal['patient_answers']; ?></textarea>
                        </div> 
                                </div>
                    </li>
                    <?php }
                    break;
                case 'date':
                    $question++;
                    $tabindex = 'tabindex="' . $question . '"';
                    $fieldType = explode('|', $quesVal['type']);
                    if($fieldType[1] != 'techquestions'){
                    ?>
                   
                    <li class="listbox" <?php echo $parentAnswer; ?> validClass="<?php echo $quesVal['validate_class']; ?>" errorlabel="<?php echo $quesVal['error_label']; ?>" 
                        style="width:<?php echo $quesVal['width'] . '%'; ?>;display:<?php echo $quesVal['display']; ?>;  <?php if(in_array($quesVal['id'], array('1366'))){ echo "float:left";}?>" <?php

                        if ($quesVal['parent_ques_id']) {
                            echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'";
                        }?>>
                        <?php if(in_array($quesVal['id'], array('1366'))){ 
                            echo "<div class='row indent_outer questionerList_liNoBorder'>";
                        }
                        else{ ?>
                            <div class="row <?php echo $subClass; ?>"><?php 
                        }
                        if ($quesVal['width'] == '30' || $quesVal['width'] == '31') {
                            echo $mandatory.''."<strong>" . $quesVal['question_text'] . "</strong>";
                        } 
                        else{
                            echo '<div class="questionTxt col-lg-9 col-md-9 col-sm-12 col-xs-12 12377" style="display:inline-block">'.$mandatory.''.$quesVal['question_text'].'</div>';
                        }
                        if ($quesVal['has_dependent_form'] == '1') {?>
                            <input type="hidden" name="has_dependent_form_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['has_dependent_form']; ?>"> <?php
                        }
                        if ($quesVal['width'] == '100') { ?>
                            <div class="btnYesNo_depend padBT0 col-lg-3 col-md-3 col-sm-12 col-xs-12 mob-margin-top-15">
                                <input class="dateValid" type="text" name="answer_date_<?php echo $quesVal['id']; ?>" id="answer_date_<?php echo $quesVal['id']; ?>" 
                                value="<?php echo $quesVal['patient_answers'] ? date('m/d/Y', strtotime($quesVal['patient_answers'])) : ''; ?>" 
                                maxlength="10" onkeypress="ValidateMe(this, 'Numbers', 10, '##/##/####', event);" 
                                onkeyup="ValidateMe(this, 'Numbers', 10, '##/##/####', event);" placeholder='mm/dd/yyyy' <?php echo $optional; ?>  
                                <?php echo $tabindex; ?> onblur="ajaxSave('answer_date_<?php echo $quesVal['id']; ?>');" style="width:100px;">	
                            </div>	<?php 
                        } 
                        else {?>
                            <input type="text" name="answer_date_<?php echo $quesVal['id']; ?>" id="answer_date_<?php echo $quesVal['id']; ?>" value="<?php echo date('Y-m-d H:i:s'); ?>" <?php echo $optional; ?>  <?php echo $tabindex; ?>>
                        <?php }?>
						</div>
                    </li> 
                    <?php }
                 
                    break;
                case 'image':
                    ?>
                    <script type="text/javascript">
                        var coOrdinates = [];
                        var clearflag = false;
                    </script>
                    <?php

                        $patAns = unserialize($quesVal['patient_answers']); 
                        
                        foreach ($patAns as $key => $value) { 
                            $offsetArr = explode(":", $value); 

                            $webArray = explode(",", $offsetArr[0]);
                            $pdfArray = explode(",", $offsetArr[1]);    
                            ?>

                            <script type="text/javascript">
                            
                            if(!clearflag){
                                coOrdinates.push({'left' : <?php echo $webArray[0]; ?>, 'top': <?php echo $webArray[1]; ?>, 'divX':<?php echo $pdfArray[0]; ?>, 'divY': <?php echo $pdfArray[1]; ?> });
                                    $(document).ready(function(){
                                        
                                        console.log(<?php echo $webArray[0]; ?>);
                                        console.log(<?php echo $webArray[1]; ?>);
                                        
                                        //oldWidth = $(window).width();
                                        
                                        $('.map').append($('<i class="fa fa-crosshairs " />').css({
                                            color: 'red',
                                            position: 'absolute',
                                            left: <?php echo $webArray[0]; ?>,
                                            top: <?php echo $webArray[1]; ?>
                                        }));
                                    });

                                    $( window ).resize(function() {
                                        drawCoordinates(<?php echo $webArray[0]; ?>, <?php echo $webArray[1]; ?>);
                                    });

                            }*/
                            </script>
                       <?php }?> 

                       <script>
                            $('.map img').on('click', function(ev) {
                                
                                var bounds = $("#canvas")[0].getBoundingClientRect();

                                var x = ev.clientX - bounds.left;
                                var y = ev.clientY - bounds.top;
                                
                                console.log(ev, $(this));

                                

                                /*$('.map').append($('<i class="fa fa-crosshairs " />').css({
                                    color: 'red',
                                    position: 'absolute',
                                    left: ev.pageX - 7,
                                    top: ev.pageY - 7
                                }));*/


                                var X = ev.pageX - $('.map img').offset().left;
                                var Y = ev.pageY - $('.map img').offset().top;

                                var divX = Math.ceil(X);
                                var divY = Math.ceil(Y);
                                /*console.log(divX);
                                console.log(divY);*/
                                coOrdinates.push({'left' : x, 'top': y , 'divX':divX, 'divY':divY });
                                
                                $('#markbodypart').prop('checked', false);
                                ajaxSave('answer_image_<?php echo $quesVal['id']; ?>');
                                drawCoordinates(x,y);
                            }); 

                            function drawCoordinates(x,y){
                                console.log(coOrdinates);
                                var rect = $('#canvas').offset();

                                var x_rel = (x - 7)+rect.left;
                                var y_rel = (y - 7)+rect.top;

                                $('.map').append($('<i class="fa fa-crosshairs " />').css({
                                    color: 'red',
                                    position: 'absolute',
                                    left: x_rel,
                                    top: y_rel
                                }));
                            }
                        </script>            
                    
                        <div class="map" id="canvas">      
                            <?php echo "<img src='/".$quesVal['question_text']."' style='cursor: crosshair;' alt='body FRONT BACK' width='500'>" ?>       
                            <div class="form-group text-center">
                                <div class="checkbox">
                                <!--<label> -->
                                    <!-- <input type="checkbox" onclick ="removeMarks(<?php echo $quesVal['id']; ?>);" id = "markbodypart"  <?php //if(empty($quesVal['patient_answers'])){//echo "checked";} ?>  > NOT CURRENTLY EXPERIENCING PAIN-->
                                <!-- </label>-->
                                <label>
                                <a class="btn btn-primary" href ="javascript:void(0);" onclick ="removeMarks(<?php echo $quesVal['id']; ?>,<?php //echo $value['id']; ?>);" >Remove All Marks </a>
                                </label>
                                </div>
                            </div>
                        </div>

                        <!-- <span ng-repeat="(key, answer) in answerAttributeArray" ng-init="setDefaultValue(answer.default_value, 'frm' + frmIndex + 'Q' + queid.ordering + answer.uniqueAnsKey, 'number')"> 
                            <div class="map" style="position: relative; display: inline-block">
                                    <img src='/images/FormAutomation/{{answer.attribute_value}}' id="img_coordinates" style='cursor: crosshair;' alt='img' width='500' >
                                    
                                    <canvas id="canvas" width="500" height="500" style="cursor:crosshair"></canvas>
                                    
                                    <input type="text" id='imageName' name ='imageName' style="display:none;" >
                            </div>
                            <div class="form-group removemark" style="display:block">
                                <div class="checkbox">
                                <label style="margin:5px 0 0 0;padding: 0;">
                                    <a class="btn btn-primary" href ="javascript:void(0);" ng-attr-id="{{(queid.user_access == 'Patient' && view =='crm') ? 'disableId' : 'removeMarks'}} " >Remove All Marks</a>
                                </label>
                                </div>
                            </div>
                            <input type="hidden" id="imageparams" class="form-control" style="display:none;" value="<?php echo $quesVal['patient_answers']; ?>"/>
                            <?php
                                
                                
                            ?>
                           
                            
                        </span> -->

                    <?php
                case 'parentDesc';
                case 'desc':

                    $idArr    = range(1996, 2006);
                    array_push($idArr,2030);

                    $ctr = 0;
                    $question++;
                    $fieldType = explode('|', $quesVal['type']);
                    if($value['practice_id'] == 1223 || $value['practice_id'] == 1211)
                    {
                       $quesVal['question_text'] = str_replace("###PRACTICE_NAME###", "OpenDoctors", $quesVal['question_text']);

                    }
                    else if($value['practice_id'] == 1299 )
                    {
                       $quesVal['question_text'] = str_replace("###PRACTICE_NAME###", $practiceData['practice_name'], $quesVal['question_text']);
                    }


                    if($fieldType[1] != 'techquestions'){
                    ?>                          
                    <li <?php echo $parentAnswer; ?> class="liDescrip borB0 <?php echo $subClass; ?>" validClass="<?php echo $quesVal['validate_class']; ?>" errorlabel="<?php echo $quesVal['error_label']; ?>" style="width: 98.5%;border-bottom:none;display:<?php echo $quesVal['display']; ?>" <?php
                    if ($quesVal['parent_ques_id']) {
                        echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'";
                    }
                    ?>>
                    <?php if ($quesVal['has_dependent_form'] == '1') { ?>
                        <input type="hidden" name="has_dependent_form_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['has_dependent_form']; ?>">
                    <?php }
                      if(!in_array($quesVal['id'] , array('482','483','484','485','481','892','1066','1065','1120','1121','1122','1123','1130','1131','1234','1170','1172','1174','1176','1178','1179','1180','1181','1182','1184', '1185', '1186', '1187','1188','1189','476','588')))
                    {
                        $class = "questionTxt";
                    } else{
                        $class =  "";
                    }
                    if( in_array($quesVal['id'], array('1172','1176','1286','1305')) ){
                        // "PATIENTS_NAME" is inserted as constatnt in databse
                        $patient_name = strtoupper($_SESSION['patient']['lastName']).", ".$_SESSION['patient']['firstName'] ;
                        $quesVal['question_text'] = str_replace("###PATIENTS_NAME###", $patient_name, $quesVal['question_text']);
                    }elseif( in_array($quesVal['id'], array('1178','1184')) ){
                        // "JOINTS_NAME" is inserted as constatnt in databse
                        $appointmentObj = new Application_Model_Appointments();
                        $typeOfTestArr = $appointmentObj->fetchRfcDetailsForAppointment(array($this->apptDetails['id']));

                        foreach ($typeOfTestArr as $key5 => $value) {
                                $quesVal['question_text'] = str_replace("###JOINTS_NAME###", $value['subbody_part'], $quesVal['question_text']);
                        } 

                    }elseif(in_array($quesVal['id'], $idArr)){
                        $quesVal['question_text'] = str_replace("###ADDRESS###", $this->patientData['address1'], $quesVal['question_text']);

                        $add2 = $this->patientData['address2'] ? $this->patientData['address2'] :"N/A" ;

                        $quesVal['question_text'] = str_replace("###ADDRESS2###", $add2, $quesVal['question_text']);
                        
                        $quesVal['question_text'] = str_replace("###CITY###", $this->patientData['city'], $quesVal['question_text']);      
                        $quesVal['question_text'] = str_replace("###STATE###", $this->patientData['state_name'], $quesVal['question_text']);
                        $quesVal['question_text'] = str_replace("###ZIP###", $this->patientData['zip'], $quesVal['question_text']);
                        $quesVal['question_text'] = str_replace("###PATIENT_AGE###", $age, $quesVal['question_text']);
                        $homephone = $this->patientData['phone_number2'] ? $this->patientData['phone_number2'] :"N/A";
                        $quesVal['question_text'] = str_replace("###PHONE###", $homephone, $quesVal['question_text']);

                        $workphone = $this->patientData['phone_number'] ? $this->patientData['phone_number'] : "N/A";
                        $quesVal['question_text'] = str_replace("###PHONE2###", $workphone, $quesVal['question_text']);
                        $quesVal['question_text'] = str_replace("###CELL###", $this->patientData['cell'], $quesVal['question_text']);
                       
                        $quesVal['question_text'] = str_replace("###SSN###", $this->patientData['ssn_last4digits'], $quesVal['question_text']);
                        $quesVal['question_text'] = str_replace("###EMAILID###", $this->patientData['email_address'], $quesVal['question_text']);
                    }

                    elseif (in_array($quesVal['id'], array('1352')) ){
                        $quesVal['question_text'] = str_replace("###PATIENT_AGE###", $age, $quesVal['question_text']);
                    }

                    elseif(in_array($quesVal['id'], array('2015','2016','2017'))){
                        
                        $apptInsObj = new Application_Model_ApptInsurance();
                        $apptInsurances = $apptInsObj->getpatientInsuranceByAppointmentId($this->apptDetails['id'], $value["practice_id"]);
                        if(empty($apptInsurances)){
                            $apptInsurances = $apptInsObj->getInsuranceByAppointmentId($this->apptDetails['id'], $value["practice_id"]);
                        }

                        if(empty($apptInsurances))
                        {
                            $apptInsurances = $apptInsObj->getInsuranceNameByAppointmentId($this->apptDetails['id']);
                        }
                        
                        if(!empty($apptInsurances)){
                            foreach ($apptInsurances as $inskey => $Insvalue) {
                                if($Insvalue['ins_type'] == 1){
                                    $quesVal['question_text'] = str_replace("###INS1###", " : ".$Insvalue['insurance_name'], $quesVal['question_text']);       
                                }

                                if($Insvalue['ins_type'] == '2'){ 
                                    $quesVal['question_text'] = str_replace("###INS2###", " : ".$Insvalue['insurance_name'], $quesVal['question_text']);       
                                }
                                if($Insvalue['ins_type'] == 3){
                                    $quesVal['question_text'] = str_replace("###INS3###", " : ".$Insvalue['insurance_name'], $quesVal['question_text']);       
                                }
                            }
                        }
                        // if no ins, remove INS1, INS2, INS3 
                        $quesVal['question_text'] = str_replace("###INS1###", "", $quesVal['question_text']);       
                        $quesVal['question_text'] = str_replace("###INS2###", "", $quesVal['question_text']);       
                        $quesVal['question_text'] = str_replace("###INS3###", "", $quesVal['question_text']); 

                    }

                    elseif( in_array($quesVal['id'], array('1344','1441','1570','1390','2007','2008')) ){
                        
                        $appointmentObj = new Application_Model_Appointments();
                        $typeOfTestArr = $appointmentObj->fetchRfcDetailsForAppointment(array($this->apptDetails['id']));


                        $provderLoc = new Application_Model_ProviderLocations();
                        $providerLocdata = $provderLoc->fetchLocationDetailsByLocationId($this->apptDetails['provider_location_id']);
                        
                        $quesVal['question_text'] = str_replace("###LOCADD###", $providerLocdata['address1'], $quesVal['question_text']);
                        $locadd2 = $providerLocdata['address2'] ? $providerLocdata['address2']." ,".$providerLocdata['city'] :$providerLocdata['city'];
                        $quesVal['question_text'] = str_replace("###LOCADD2###", $locadd2, $quesVal['question_text']);

                        //$quesVal['question_text'] = str_replace("###CITY###", $providerLocdata['city'], $quesVal['question_text']);      
                        $quesVal['question_text'] = str_replace("###STATE###", $this->states[$providerLocdata['state']], $quesVal['question_text']);
                        $quesVal['question_text'] = str_replace("###ZIP###", $providerLocdata['zip'], $quesVal['question_text']);
                        
                        $quesVal['question_text'] = str_replace("###PHONE###", $providerLocdata['phone_number'], $quesVal['question_text']);

                        $refDoc = new Application_Model_ReferrerDoctors();

                        $allData = $refDoc->fetchReferringDoctorById($typeOfTestArr[$this->apptDetails['id']]['referring_doctor_id']);

                        $refDocAddr = $allData['address1'].",".$allData['address2'];

                        $quesVal['question_text'] = str_replace("###REF_DOC_ADD###", $refDocAddr, $quesVal['question_text']);

                        foreach ($typeOfTestArr as $key => $typeTestval) {
                                $quesVal['question_text'] = str_replace("###exam###", $typeTestval['technology']." ".$typeTestval['body_part']." ".$typeTestval['subbody_part'], $quesVal['question_text']);
                                $quesVal['question_text'] = str_replace("###Physician Name###", $typeTestval['referring_name'], $quesVal['question_text']);
                        }
                    }
                    ?>
                       <div class="<?php echo $class ?> padding-left-15" id="<?php echo 'desc_'.$quesVal['id'];?>">
                       <?php 
                       $quesVal['question_text'] = str_replace("images/breast.jpg",'',$quesVal['question_text']);
                       echo str_replace("images/body-front-back.jpg",'',$quesVal['question_text']); ?>
                       </div>
                    </li> 

                    <?php }
                  
                    break;   
                case 'address':
                    $fieldType = explode('|', $quesVal['type']);
                    $fieldCount = count($fieldType);
                    $validation = "";
                    ?>
                                                <li <?php echo $parentAnswer; ?> validClass="<?php echo $quesVal['validate_class']; ?>" errorlabel="<?php echo $quesVal['error_label']; ?>" style="width:100%;display:<?php echo $quesVal['display']; ?>" <?php
                                                if ($quesVal['parent_ques_id']) {
                        echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'";
                                                }
                                                ?>>
                    					<div class="<?php echo $subClass; ?>">
                    						<div class="questionTxt"><?php echo $mandatory;   echo $quesVal['question_text']; ?></div>
                    					</div>
                    				</li>
                    <?php if ($quesVal['has_dependent_form'] == '1') { ?>
                                                            <input type="hidden" name="has_dependent_form_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['has_dependent_form']; ?>">
                    <?php } ?>
                                                <li validClass="<?php echo $quesVal['validate_class']; ?>" errorlabel="<?php echo $quesVal['error_label']; ?>" style="width:100%;display:<?php echo $quesVal['display']; ?>" <?php
                                                if ($quesVal['parent_ques_id']) {
                        echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'";
                                                }
                                                ?>>
                    <?php
                    $answers = explode('|', $quesVal['patient_answers']);
                    for ($element = 1; $element < $fieldCount; $element++) {
                        $question++;
                        $tabindex = 'tabindex="' . $question . '"';
                        $preUnit = "";
                        $unit = "";
                        if ($fieldType[$element] == 'Address1') {
                                                            $address1 = ($answers[$element - 1] != "") ? $answers[$element - 1] : $this->apptDetails['address1'];
                    ?>
                            									<div class="dependSub_li"><div class="dependSub_li_div">Address 1</div><div><span class="mandatoryStar">*</span>
                                                            <input class="addressInput" type="text" onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" 
                                                                   id="answer_text_<?php echo $quesVal['id']; ?>_<?php echo $element; ?>" name="answer_text_<?php echo $quesVal['id']; ?>[]" 
                                                                   value="<?php echo $address1; ?>" maxlength="64"  <?php echo $optional . " " . $validation; ?> placeholder="<?php echo $fieldType[$element]; ?>" <?php echo $tabindex . " " . $autofocus; ?>></div></div>
                            <?php
                        } elseif ($fieldType[$element] == 'Address2') {
                                                            $address2 = ($answers[$element - 1] != "") ? $answers[$element - 1] : $this->apptDetails['address2'];
                            ?>
                            									<div class="dependSub_li"><div class="dependSub_li_div">Address 2</div><div>
                                                            <input class="addressInput1" type="text" onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" 
                                                                   id="answer_text_<?php echo $quesVal['id']; ?>_<?php echo $element; ?>" name="answer_text_<?php echo $quesVal['id']; ?>[]" 
                                                                   value="<?php echo $address2; ?>" maxlength="64"  optional="true" <?php echo $validation; ?> placeholder="<?php echo $fieldType[$element]; ?>" <?php echo $tabindex . " " . $autofocus; ?>></div></div>
                            <?php
                        } elseif ($fieldType[$element] == 'City') {
                                                            $city = ($answers[$element - 1] != "") ? $answers[$element - 1] : $this->apptDetails['city'];
                            ?>
                            									<div class="dependSub_li"><div class="dependSub_li_div">City</div><div><span class="mandatoryStar">*</span>
                                                                    <input class="addressInput" type="text" onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" 
                                                                           id="answer_text_<?php echo $quesVal['id']; ?>_<?php echo $element; ?>" name="answer_text_<?php echo $quesVal['id']; ?>[]" 
                                                                           value="<?php echo $city; ?>" <?php echo $optional . " " . $validation; ?> maxlength="64"  placeholder="<?php echo $fieldType[$element]; ?>" <?php echo $tabindex . " " . $autofocus; ?> onkeypress="ValidateMe(this, 'Signature', '', '', event);" onkeyup="ValidateMe(this, 'Signature', '', '', event);"
                            									onkeydown="ValidateMe(this, 'Signature', '', '', event);"
                            									></div></div>
                            <?php
                        } elseif ($fieldType[$element] == 'State') {
                            $state = ($answers[$element - 1] != "") ? $answers[$element - 1] : $this->apptDetails['state'];
                            ?>
                            									<div class="dependSub_li"><div class="dependSub_li_divState">State</div><div><span class="mandatoryStar">*</span>
                                                                    <select class="addressSelect" onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" id="answer_text_<?php echo $quesVal['id']; ?>_<?php echo $element; ?>" name="answer_text_<?php echo $quesVal['id']; ?>[]" <?php
                                    echo $optional . " " . $validation . " " . $tabindex . " " . $autofocus;
                                    ;
                            ?>>
                            <?php
                            echo "<option value=''> Please Select </option>";
                            foreach ($this->stateOption AS $stateKey => $stateVal) {
                                $selected = "";
                                                                                    if ($state == $stateKey) {
                                    $selected = "SELECTED";
                                }
                                                                                    echo "<option value='" . $stateKey . "' " . $selected . ">" . $stateVal . "</option>";
                            }
                            ?>	
                            									</select>
                            									</div></div>
                            <?php
                        } elseif ($fieldType[$element] == 'Zip') {
                                                            $zip = ($answers[$element - 1] != "") ? $answers[$element - 1] : $this->apptDetails['zip'];
                            ?> <script type="text/javascript">
                                $(document).ready(function(){
                                    $('#answer_text_<?php echo $quesVal['id']; ?>_<?php echo $element; ?>').live("cut copy paste",function(e) {
                                        e.preventDefault();
                                    });
                                });
                            </script>
                            									<div class="dependSub_li"><div class="dependSub_li_div">Zip Code</div><div validClass="zip" errorlabel="invalid Zip Code"><span class="mandatoryStar">*</span>
                                                                    <input type="text" class="addressInput zipCheck" onblur="ajaxSave('answer_text_<?php echo $quesVal['id']; ?>[]');" id="answer_text_<?php echo $quesVal['id']; ?>_<?php echo $element; ?>" name="answer_text_<?php echo $quesVal['id']; ?>[]" onkeypress="return validateCond(this, event);" onkeyup="return  validateCond(this, event);" 
                                                                           value="<?php echo $zip; ?>" <?php echo $optional . " " . $validation; ?> placeholder="Zip Code" <?php echo $tabindex . " " . $autofocus; ?> maxlength="10"></div></div>
                            <?php
                        }
                    }
                            ?>
                    						<div class="requiredText"><span class="mandatoryStar">*&nbsp;</span>Indicates required fields</div>
                                                </li>                        
                    <?php
                    break;
                case 'patient_cell':
                   $fieldType = explode('|', $quesVal['type']);
                   $fieldCount = count($fieldType);
                   $validation = "";
                   ?>
                                                <li type="cell" <?php echo $parentAnswer; ?> validClass="patient_cell" errorlabel="<?php echo $quesVal['error_label']; ?>" style="width:100%;display:<?php echo $quesVal['display']; ?>" <?php
                            if ($quesVal['parent_ques_id']) {
                       echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'";
                            }
                                                ?>>
                                       <div class="<?php echo $subClass; ?>">
                                           <div class="questionTxt"><?php echo $mandatory; echo $quesVal['question_text']; ?></div>
                                       </div>
                                   </li>
                   <?php if ($quesVal['has_dependent_form'] == '1') { ?>
                                                           <input type="hidden" name="has_dependent_form_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['has_dependent_form']; ?>">
                   <?php } ?>
                                                <li validClass="<?php echo $quesVal['validate_class']; ?>" errorlabel="<?php echo $quesVal['error_label']; ?>" style="width:100%;display:<?php echo $quesVal['display']; ?>" <?php
                            if ($quesVal['parent_ques_id']) {
                       echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'";
                            }
                                                ?>>
                   <?php
                   $answers = explode('|', $quesVal['patient_answers']);
                   /*for ($element = 1; $element < $fieldCount; $element++)*/
                       $question++;
                       $tabindex = 'tabindex="' . $question . '"';
                       $preUnit = "";
                       $unit = "";
                       $cellArr = explode('|',$quesVal['patient_answers']);
?>
                                                    <div class="dependSub_li"><div class="dependSub_li_div">Cell Number</div>
                                                        <div>
                        <input class="patientCell" type="text" disabled="disabled" id="answer_cell_<?php echo $quesVal['id']; ?>_cell" name="answer_cell_<?php echo $quesVal['id']; ?>_cell" value="<?php echo $this->apptDetails['cell']; ?>" <?php echo $optional; ?> maxlength="12" onkeypress="ValidateMe(this, 'NumberOnly', 12, '###-###-####', event);" <?php echo $tabindex . " " . $autofocus; ?>></div></div>
                                                        <?php ?>
                <div class="dependSub_li"><div class="dependSub_li_div check">Primary Number</div><div>
                                                            <input class="patientCell" validClass="patient_cell" type="text" onblur="ajaxSave('answer_cell', 'cellno');" id="answer_cell_<?php echo $quesVal['id']; ?>_phone" name="answer_cell_<?php echo $quesVal['id']; ?>_phone" <?php
                                if (strtolower($cellArr[0]) == 'on') {
                                    echo 'disabled="disabled""';
                                }
                                                    ?> value="<?php
                                                                   if (strtolower($cellArr[0]) == 'on') {
                                                                       echo $this->apptDetails['cell'];
                                                                   } elseif ($cellArr[0]) {
                                                                       echo $cellArr[0];
                                                                   }
                                                                   ?>" <?php echo $optional; ?> maxlength="12" onkeypress="ValidateMe(this, 'NumberOnly', 12, '###-###-####', event);" <?php echo $tabindex . " " . $autofocus; ?>> &nbsp; 
                                                            <input class="patientCellcheck" type="checkbox" id="answer_cell_<?php echo $quesVal['id']; ?>_same" name="answer_cell_<?php echo $quesVal['id']; ?>['same']" <?php
                                                            if (strtolower($cellArr[0]) == 'on') {
                                                                echo 'checked="checked""';
                                                            }
                                                            ?> onchange="samecell(this, 'answer_cell<?php echo $quesVal['id']; ?>_cell', 'answer_cell<?php echo $quesVal['id']; ?>_phone')" onclick="samecell(this, 'answer_cell_<?php echo $quesVal['id']; ?>_cell', 'answer_cell_<?php echo $quesVal['id']; ?>_phone');
                                                        ajaxSave('answer_cell', 'cellno');"/>Same as cell number</div>
                                                <?php
        ?>
                                           
                                               </li>                        
                   <?php
                   break;
                case 'signature':
                    if($quesVal['display'] != 'none' && $this->isMobile == true){
                        $signatureFieldExist =   'true';
                    }

                    $fieldType = explode('|', $quesVal['type']);


                    $age = $quesVal['patient_age'];
                    $display = "show";
                    if ($quesVal['age_limit'] == '<18') {
                        if (!($age <= 18)) {
                            $display = "hide";
                        }
                    } elseif ($quesVal['age_limit'] == '>18') {
                        if (!($age > 18)) {
                            $display = "hide";
                        }
                    }
                    if ($display == 'show') {
                        if($fieldType[1] != 'techquestions'){
                            $question++;
                            $tabindex = 'tabindex="' . $question . '"';?>
                            <li <?php echo $parentAnswer; ?> class='borB0 panel-footer inner-box-header inner clearfix rounded-0 mb20 signature <?php echo $subClass; ?>' validClass="<?php echo $quesVal['validate_class']; ?>" errorlabel="<?php echo $quesVal['error_label']; ?>" style="clear:both;width:<?php echo $quesVal['width'] . '%'; ?>;display:<?php echo ($signatureFieldExist == 'true') ? 'none' : $quesVal['display']; ?>" <?php
                                if ($quesVal['parent_ques_id']) {
                                    echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'";
                                } ?>>
                                                                                    
                                <?php
                                $fieldType = explode('|', $quesVal['type']);
                                if ($fieldType['1'] == 'optional') {
                                    if ($fieldType['3'] == 'Yes') {
                                        $parentQId = 'Label_' . $fieldType['2'] . '_0';
                                        $nonparentQId = 'Label_' . $fieldType['2'] . '_1';?><?php
                                    } elseif ($fieldType['3'] == 'No') {
                                        $parentQId = 'Label_' . $fieldType['2'] . '_1';
                                        $nonparentQId = 'Label_' . $fieldType['2'] . '_0';
                                    }
                                }?>
                                <div class="<?php echo $subClass; ?>">
                                    <?php if($this->isMobile == true) {?>
                                    <div id="question_txt_signname_<?php echo $quesVal['id']; ?>" style="display:none;">
                                        <?php echo $mandatory;   echo $quesVal['question_text'];?>
                                    </div><?php 
                                    } 
                                    else {?>
                                        <div style="float: left;margin-right: 10px; margin-top:9px; margin-bottom:10px;">
                                            <!-- <span class="fieldStar">*</span>&nbsp;<strong> -->
                                                <?php echo $mandatory; echo $quesVal['question_text']; ?>
                                            </strong>
                                        </div><?php 
                                    } ?>                
                                    <?php if ($quesVal['has_dependent_form'] == '1') { ?>
                                        <input type="hidden" name="has_dependent_form_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['has_dependent_form']; ?>">
                                    <?php } ?>
                                    <div class="formData sigPad padB0" style="float: left;" >
                                    	<div class="sigWrapper2">
                                            <?php if($this->isMobile == true){ ?>
                                            <div class="typed23">
                                                <input type="hidden" autocomplete="off" name="answer_signname_<?php echo $quesVal['id'];?>" id="answer_signname_<?php echo $quesVal['id']; ?>" class="signname left " value='' style="display:none;" <?php echo $optional; ?> />
            								</div><?php 
                                            } 
                                            else { ?>
                                    		<div class="typed23">
                                                <input type="text" autocomplete="off" name="answer_signname_<?php echo $quesVal['id']; ?>" id="answer_signname_<?php echo $quesVal['id']; ?>" class="signname left form-control" maxlength="25" value="<?php
                                                if ($quesVal['patient_answers'] && !strstr($quesVal['patient_answers'],'<image>')) {
                                                    echo $quesVal['patient_answers'];
                                                } else
                                                echo "Type Your Name";?>" 
                                            <?php echo $optional; ?> onkeypress="ValidateMe(this, 'Signature', 0, '', event);" onkeyup="ValidateMe(this, 'Signature', 0, '', event);" onkeydown="ValidateMe(this, 'Signature', 0, '', event);" onblur="restrictSignaturePaste(this);
                                                    if (this.value == '')
                                                        this.value = 'Type Your Name';
                                                        ajaxSave('answer_signname_<?php echo $quesVal['id']; ?>');" onfocus="if (this.value == 'Type Your Name')
                                                        this.value = '';" placeholder="Type Your Name" <?php echo $tabindex . " " . $autofocus; ?>>
                                            </div>
                                            <?php } ?>                    
                                    	</div>
                                    </div>
                                </div>
                                <?php
                                if ($question == 1) {
                                    echo "<script>$('#answer_signname_" . $quesVal['id'] . "').focus();</script>";
                                }
                                ?>
                            </li>
                            <?php
                        }  
                    } ?>
                    <script type="text/javascript">
                        $(document).ready(function() {
                            signatureFieldExist =   false;
                        <?php if($signatureFieldExist == 'true' && $this->isMobile == true){?>
                            signatureFieldExist =   true;
                        <?php }?>
                        <?php if(!empty($quesVal['parent_ques_id'])){ ?>
                            $('[id^="Label_<?php echo $quesVal['parent_ques_id'];?>"]').click(function(){
                                if($('[name^="answer_radio_<?php echo $quesVal['parent_ques_id'];?>"]:checked').val() === '<?php echo trim($quesVal['parent_answer']);?>' /*&& $this->isMobile == true*/){
                                    $('#submit, #next').html("Accept & Sign");
                                    signatureFieldExist =   true;
                                }else{
                                    $('#submit, #next').html("Submit");
                                    signatureFieldExist =   false;
                                }
                            });
                        <?php } ?>
                        <?php if ($parentQId) { ?>
                            if ($('#<?php echo $parentQId; ?>').hasClass('RadioSelected')) {
                                $('#answer_signname_<?php echo $quesVal['id']; ?>').attr('optional', 'true');
                            }
                            $('#<?php echo $parentQId; ?>').click(function() {
                                $('#answer_signname_<?php echo $quesVal['id']; ?>').attr('optional', 'true');
                            });
                        <?php } if ($nonparentQId) { ?>
                            $('#<?php echo $nonparentQId; ?>').click(function() {
                                $('#answer_signname_<?php echo $quesVal['id']; ?>').attr('optional', 'false');
                            });
                        <?php } ?>
                        });
                    </script>
                        <?php
                    break;
                case 'image-checkbox':
                    $patientAnswerArr = explode('|', $quesVal['patient_answers']);
                    ?>
                                                <script type="text/javascript">
                                                    $('.checkSelect').click(function() {
                                                        var checkIds = this.id.split('_');
                                                        if ($('#divCheck' + checkIds[3]).css("display") == "none") {
                                                            $('#divCheck' + checkIds[3]).show();
                                                        } else {
                                                            $('#divCheck' + checkIds[3]).hide();
                                                        }
                                                    });
                                                </script>

                                                                <li <?php echo $parentAnswer; ?> validClass="<?php echo $quesVal['validate_class']; ?>" errorlabel="<?php echo $quesVal['error_label']; ?>" style="width:<?php echo $quesVal['width'] . '%'; ?>;display:<?php echo $quesVal['display']; ?>" <?php
                    if ($quesVal['parent_ques_id']) {
                        echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'";
                    }
                    ?>>
                                                                    <div class="<?php echo $subClass; ?>">
                                                 <?php echo $mandatory; ?> <strong><?php echo $quesVal['question_text']; ?></strong>
                    <?php if ($quesVal['has_dependent_form'] == '1') { ?>
                                                            <input type="hidden" name="has_dependent_form_<?php echo $quesVal['id']; ?>" value="<?php echo $quesVal['has_dependent_form']; ?>">
                    <?php } ?>
                                                  <div class='innerTBPad'>
                                                      <div class="dvMemoImg">
                                                                                <div style="display:<?php
                    if (in_array('Right Breast-Top Right', $patientAnswerArr)) {
                        echo 'block';
                    } else {
                        echo 'none';
                    }
                    ?>" id="divCheck0" class="rightTopRight"> </div>
                                                                                <div style="display:<?php
                    if (in_array('Left Breast-Top Right', $patientAnswerArr)) {
                        echo 'block';
                    } else {
                        echo 'none';
                    }
                    ?>" id="divCheck1" class="leftTopRight"> </div>
                                                                                <div style="display:<?php
                    if (in_array('Right Breast-Top Left', $patientAnswerArr)) {
                        echo 'block';
                    } else {
                        echo 'none';
                    }
                    ?>" id="divCheck2" class="rightTopLeft"> </div>
                                                                                <div style="display:<?php
                    if (in_array('Left Breast-Top Left', $patientAnswerArr)) {
                        echo 'block';
                    } else {
                        echo 'none';
                    }
                    ?>" id="divCheck3" class="leftTopLeft"> </div>
                                                                                <div style="display:<?php
                    if (in_array('Right Breast-Bottom Right', $patientAnswerArr)) {
                        echo 'block';
                    } else {
                        echo 'none';
                    }
                    ?>" id="divCheck4" class="rightBottomRight"> </div>
                                                                                <div style="display:<?php
                    if (in_array('Left Breast-Bottom Right', $patientAnswerArr)) {
                        echo 'block';
                    } else {
                        echo 'none';
                    }
                    ?>" id="divCheck5" class="leftBottomRight"> </div>
                                                                                <div style="display:<?php
                    if (in_array('Right Breast-Bottom Left', $patientAnswerArr)) {
                        echo 'block';
                    } else {
                        echo 'none';
                    }
                    ?>" id="divCheck6" class="rightBottomLeft"> </div>
                                                                                <div style="display:<?php
                    if (in_array('Left Breast-Bottom Left', $patientAnswerArr)) {
                        echo 'block';
                    } else {
                        echo 'none';
                    }
                    ?>" id="divCheck7" class="leftBottomLeft"> </div>
                                                                                <div style="display:<?php
                    if (in_array('Right Breast-Nipple', $patientAnswerArr)) {
                        echo 'block';
                    } else {
                        echo 'none';
                    }
                    ?>" id="divCheck8" class="rightNipple"> </div>
                                                                                <div style="display:<?php
                    if (in_array('Left Breast-Nipple', $patientAnswerArr)) {
                        echo 'block';
                    } else {
                        echo 'none';
                    }
                    ?>" id="divCheck9" class="leftNipple"> </div>
                                                      </div>
                                                      <div class="fl">
                                                        <table cellspacing="0" cellpadding="0" border="0" class="checkBoxTbl">
                                                        <tbody>
                                                        <tr>
                                                        <th></th>
                                                        <th>Right Breast</th>
                                                        <th>Left Breast</th>
                                                        </tr>
                    <?php
                    foreach ($answerArr AS $AnswerKey => $AnswerVal) {
                        $question++;
                        $tabindex = 'tabindex="' . $question . '"';
                        $AnswerCheck = explode('-', $AnswerVal);
                        if ($AnswerCheck['0'] == 'Right Breast') {
                    ?>
                                                                        <tr class="altRow">
                                                                        <td><?php echo $AnswerCheck['1']; ?></td>
                                                                        <td align="center">
                                                                                                                <input name='answer_image_<?php echo $quesVal['id']; ?>[]' onblur="ajaxSave('answer_image_<?php echo $quesVal['id']; ?>');" id='answer_image_<?php echo $quesVal['id'] . '_' . $AnswerKey; ?>' type="checkbox" value="<?php echo $AnswerVal; ?>" class="checkSelect" <?php
                            if (in_array($AnswerVal, $patientAnswerArr)) {
                                echo 'checked="checked"';
                            }
                    ?>  <?php echo $optional; ?>  <?php echo $tabindex . " " . $autofocus; ?>>
                                                                        </td>
                        <?php } else { ?>
                                                                        <td align="center">
                                                                                                                <input name='answer_image_<?php echo $quesVal['id']; ?>[]' onblur="ajaxSave('answer_image_<?php echo $quesVal['id']; ?>');" id='answer_image_<?php echo $quesVal['id'] . '_' . $AnswerKey; ?>' type="checkbox" value="<?php echo $AnswerVal; ?>" class="checkSelect" <?php
                            if (in_array($AnswerVal, $patientAnswerArr)) {
                                echo 'checked="checked"';
                            }
                        ?>  <?php echo $tabindex . " " . $autofocus; ?>>
                                                                        </td>
                                                                        </tr>
                            <?php
                        }
                    }
                            ?>
                                                                    </tbody>
                    											</table>
                                                    </div>                              
                                                  </div>
                                                  <div class="clear"> </div>
                                                                    </div>
                                                </li>                        
                    <?php
                    break;
                case 'table':
                    
                    $tablePatientAnswer = array();
                    if ($quesVal['patient_answers']) {
                        $tablePatientAnswer = unserialize($quesVal['patient_answers']);
                    }

                    $maxLength = '';
                    if($quesVal['field_length'] >= '1') {
                        $maxLength = "maxlength='".$quesVal['field_length']."'";
                    } ?>
                    <script>
                        counterVariables.push('<?php echo $fieldType[1];?>');
                        counterVariables['<?php echo $fieldType[1];?>'] = 1;
                    </script> 
                    <?php
                    
                    $fieldType = explode('|', $quesVal['type']);
                    if ($value['questions'][$quesVal['parent_ques_id']]['patient_answers'] == 'Yes') {
                        $show = "block";
                    } else {
                        $show = "none";
                    }
                    // DesignateThirdParty and RelationshipToPatient - Add More Starts
                    if (in_array($fieldType[1], array('Two_column_tbl'))){  ?>
                       
                        <table cellpadding="0" cellspacing="0" border="0" width="100%" class="formTable newtable" id="table_<?php echo $quesVal['id'];?>">

                                <?php if(!empty($fieldType[2]) && !empty($fieldType[3])){?>         
                                    <tr>
                                        <td class="th" width="45%"><?php echo $fieldType[2];?></td>
                                        <td class="th" width="45%"><?php echo $fieldType[3];?></td>
                                    </tr>
                                <?php } else{?>
                                <tr>
                                    <td class="th" width="45%">Designate Third Party:</td>
                                    <td class="th" width="45%">Relationship to Patient:</td>
                                </tr>
                                <?php }?>

                                <tr id = "tr_1">
                                    <td id="td_1">
                                        <?php $validation = 'onkeypress="ValidateMe(this,\'Names\',50,\'\',event)"';?>
                                        <input class="form-control" maxlength = "50" <?php echo $validation; ?> onblur="ajaxSave('answer_table_<?php echo $quesVal['id'];?>[1][designateThirdParty]', 'table');" type="text" name="answer_table_<?php echo $quesVal['id']; ?>[1][designateThirdParty]" id="answer_table_<?php echo $quesVal['id']; ?>[1][designateThirdParty]" value="<?php echo $tablePatientAnswer[1]['designateThirdParty'];?>" <?php echo  $maxLength; ?>>
                                    </td>
                                    <?php if( $fieldType[3] == 'DOB' || $fieldType[3] == 'Date of Exam'){ ?>
                                        <td> 
                                            <input class="form-control" type="text" name="answer_table_<?php echo $quesVal['id']; ?>[1][pastDate]" id="answer_table_<?php echo $quesVal['id']; ?>[1][pastDate]" value="<?php echo $tablePatientAnswer[1]['pastDate'];?>" maxlength="10" onkeypress="ValidateMe(this, 'Numbers', 10, '##/##/####', event);" 
                                            onkeyup="ValidateMe(this, 'NumberOnly', 10, '##/##/####', event);" placeholder='mm/dd/yyyy' <?php echo $optional; ?>  
                                            <?php echo $tabindex; ?> onblur="ajaxSave('answer_table_<?php echo $quesVal['id'];?>[1][pastDate]','table');" style="width:100px;">  
                                        </td>
                                    <?php } else { ?>
                                    <td>
                                        <?php $validation = 'onkeypress="ValidateMe(this,\'Names\',50,\'\',event)"';?>
                                        <input class="form-control" maxlength="50" type="text" class="tableclass" name="answer_table_<?php echo $quesVal['id']; ?>[1][relationshipToPatient]" id="answer_table_<?php echo $quesVal['id']; ?>[1][relationshipToPatient]" value="<?php echo $tablePatientAnswer[1]['relationshipToPatient'];?>" <?php echo $validation; ?>  onblur="ajaxSave('answer_table_<?php echo $quesVal['id'];?>[1][relationshipToPatient]', 'table');">  
                                    </td>
                                    <?php } ?>
                                </tr>
                        </table> 
                         <?php 
                            if (count($tablePatientAnswer) > 0) {
                                ksort($tablePatientAnswer);
                                foreach($tablePatientAnswer as $key6 => $val){
                                    ?>
                                    <script type="text/javascript">
                                        counterVariables['<?php echo $fieldType[1];?>'] = parseInt("<?php echo $key6;?>");
                                        counterVariables['<?php echo $fieldType[1];?>'] = parseInt(counterVariables['<?php echo $fieldType[1];?>']);
                                        add_table_details("<?php echo $quesVal['id']; ?>",parseInt(counterVariables['<?php echo $fieldType[1];?>']));
                                        $('#answer_table_name_<?php echo $quesVal['id']; ?>_'+counterVariables['<?php echo $fieldType[1];?>']).val('<?php echo $tablePatientAnswer[$key6]['designateThirdParty']; ?>');
                                        /*$('#<?php echo $quesVal['id']; ?>_'+parseInt(counterVariables['<?php echo $fieldType[1];?>'])+'_relationshipToPatient').val('<?php echo $tablePatientAnswer[$key6]['relationshipToPatient']; ?>');*/

                                        <?php if($fieldType[3] == 'DOB' || $fieldType[3] == 'Date of'){?>
                                            $('#<?php echo $quesVal['id']; ?>_'+parseInt(counterVariables['<?php echo $fieldType[1];?>'])+'_pastDate').val('<?php echo $tablePatientAnswer[$key6]['pastDate']; ?>');
                                        <?php } else { ?>
                                            $('#<?php echo $quesVal['id']; ?>_'+parseInt(counterVariables['<?php echo $fieldType[1];?>'])+'_relationshipToPatient').val('<?php echo $tablePatientAnswer[$key6]['relationshipToPatient']; ?>');
                                        <?php } ?>
                                        
                                   </script>
                                    <?php
                                }
                            }else{ ?>
                        <script type="text/javascript">
                            counterVariables['<?php echo $fieldType[1];?>'] = 1;
                        </script>                        
                        <?php } 
                            ?> 
                            <a id="addNamePhone" class="addRemoveIcon addmore_link" onclick="add_table_details('<?php echo $quesVal['id']?>',++counterVariables['<?php echo $fieldType[1];?>'])" ><i class="fa fa-plus-circle fa-2x"></i> Add More</a>
                <?php   }

                    if (in_array($fieldType[1], array('Two_column_tbl_depend'))){  ?>
                       <div style="display:<?php echo $show; ?>;" class="dependSub_li" <?php echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "_1'"; ?> <?php echo $parentAnswer;?>><?php echo $mandatory; echo $quesVal['question_text'];?></div>

                        <li class="grid" type="table" style="width:<?php echo $quesVal['width'] . '%'; ?>;display:<?php echo $show; ?>;" <?php echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'"; ?> validClass="<?php echo $quesVal['validate_class']; ?>" <?php echo $parentAnswer;?>>
                        <table cellpadding="0" cellspacing="0" border="0" width="100%" class="formTable newtable" id="table_<?php echo $quesVal['id'];?>">

                                <?php if(!empty($fieldType[2]) && !empty($fieldType[3])){?>         
                                    <tr>
                                        <td class="th" width="45%"><?php echo $fieldType[2];?></td>
                                        <td class="th" width="45%"><?php echo $fieldType[3];?></td>
                                    </tr>
                                <?php } else{?>
                                <tr>
                                    <td class="th" width="45%">Designate Third Party:</td>
                                    <td class="th" width="45%">Relationship to Patient:</td>
                                </tr>
                                <?php }?>

                                <tr id = "tr_1">
                                    <td id="td_1">
                                        <?php $validation = 'onkeypress="ValidateMe(this,\'Names\',50,\'\',event)"';?>
                                        <input class="form-control" maxlength = "50" <?php echo $validation; ?> onblur="ajaxSave('answer_table_<?php echo $quesVal['id'];?>[1][designateThirdParty]', 'table');" type="text" name="answer_table_<?php echo $quesVal['id']; ?>[1][designateThirdParty]" id="answer_table_<?php echo $quesVal['id']; ?>[1][designateThirdParty]" value="<?php echo $tablePatientAnswer[1]['designateThirdParty'];?>" <?php echo  $maxLength; ?>>
                                    </td>
                                    <?php if( $fieldType[3] == 'DOB' || $fieldType[3] == 'Date of Exam'){ ?>
                                        <td>
                                            <input class="form-control" type="text" name="answer_table_<?php echo $quesVal['id']; ?>[1][pastDate]" id="answer_table_<?php echo $quesVal['id']; ?>[1][pastDate]" value="<?php echo $tablePatientAnswer[1]['pastDate'];?>" maxlength="10" onkeypress="ValidateMe(this, 'NumberOnly', 10, '##/##/####', event);" 
                                            onkeyup="ValidateMe(this, 'NumberOnly', 10, '##/##/####', event);" placeholder='mm/dd/yyyy' <?php echo $optional; ?>  
                                            <?php echo $tabindex; ?> onblur="ajaxSave('answer_table_<?php echo $quesVal['id'];?>[1][pastDate]','table');" style="width:100px;">  
                                        </td>
                                    <?php } else { ?>
                                    <td>
                                        <?php $validation = 'onkeypress="ValidateMe(this,\'AlphaNum\',50,\'\',event)"';?>
                                        <input class="form-control" maxlength="50" type="text" class="tableclass" name="answer_table_<?php echo $quesVal['id']; ?>[1][relationshipToPatient]" id="answer_table_<?php echo $quesVal['id']; ?>[1][relationshipToPatient]" value="<?php echo $tablePatientAnswer[1]['relationshipToPatient'];?>" <?php echo $validation; ?>  onblur="ajaxSave('answer_table_<?php echo $quesVal['id'];?>[1][relationshipToPatient]', 'table');">  
                                    </td>
                                    <?php } ?>
                                </tr>
                        </table> 
                         <?php 
                            if (count($tablePatientAnswer) > 0) { 
                                ksort($tablePatientAnswer);
                                foreach($tablePatientAnswer as $key6 => $val){
                                    ?>
                                    <script type="text/javascript">
                                        counterVariables['<?php echo $fieldType[1];?>'] = parseInt("<?php echo $key6;?>");
                                        counterVariables['<?php echo $fieldType[1];?>'] = parseInt(counterVariables['<?php echo $fieldType[1];?>']);
                                        add_table_details("<?php echo $quesVal['id']; ?>",parseInt(counterVariables['<?php echo $fieldType[1];?>']));
                                        $('#answer_table_name_<?php echo $quesVal['id']; ?>_'+counterVariables['<?php echo $fieldType[1];?>']).val('<?php echo $tablePatientAnswer[$key6]['designateThirdParty']; ?>');
                                        /*$('#<?php echo $quesVal['id']; ?>_'+parseInt(counterVariables['<?php echo $fieldType[1];?>'])+'_relationshipToPatient').val('<?php echo $tablePatientAnswer[$key6]['relationshipToPatient']; ?>');*/

                                        <?php if($fieldType[3] == 'DOB' || $fieldType[3] == 'Date of'){?>
                                            $('#<?php echo $quesVal['id']; ?>_'+parseInt(counterVariables['<?php echo $fieldType[1];?>'])+'_pastDate').val('<?php echo $tablePatientAnswer[$key6]['pastDate']; ?>');
                                        <?php } else { ?>
                                            $('#<?php echo $quesVal['id']; ?>_'+parseInt(counterVariables['<?php echo $fieldType[1];?>'])+'_relationshipToPatient').val('<?php echo $tablePatientAnswer[$key6]['relationshipToPatient']; ?>');
                                        <?php } ?>
                                        
                                   </script>
                                    <?php
                                }
                            }else{ ?>
                        <script type="text/javascript">
                            counterVariables['<?php echo $fieldType[1];?>'] = 1;
                        </script>                        
                        <?php } 
                            ?> 
                            <a id="addNamePhone" class="addRemoveIcon addmore_link" onclick="add_table_details('<?php echo $quesVal['id']?>',++counterVariables['<?php echo $fieldType[1];?>'])" ><i class="fa fa-plus-circle fa-2x"></i> Add More</a>
                            </li>
                <?php   }
                    //Name and Phone - Add More Ends
                    //Drug Allergies, Currently Taking, Previous Sergeries Starts
                    elseif (in_array($fieldType[1], array('Drug_allergies_add','Currently_taking_add','Prev_allergies_add'))){ 
                        $placeholder = $fieldType[2];
                  ?>   
                        <table cellpadding="0" cellspacing="0" border="0" width="100%" class="formTable newtableone" id="table_<?php echo $quesVal['id'];?>">
                                <tr id = "tr_1">
                                    <td id="td_1">
                                        <input class="form-control" width="80%" maxlength = "50" onblur="ajaxSave('answer_table_<?php echo $quesVal['id'];?>[1][name]', 'table');" type="text" name="answer_table_<?php echo $quesVal['id']; ?>[1][name]" placeholder="<?php echo $placeholder; ?>" value="<?php echo $tablePatientAnswer[1]['name'];?>" <?php echo  $maxLength; ?>>
                                    </td>
                                </tr>    
                        </table> 
                         <?php 
                            if (count($tablePatientAnswer) > 0) {
                                ksort($tablePatientAnswer);
                                foreach($tablePatientAnswer as $key7 => $val){
                                    ?>
                                    <script type="text/javascript">
                                        counterVariables['<?php echo $fieldType[1];?>'] = parseInt("<?php echo $key7;?>");
                                        counterVariables['<?php echo $fieldType[1];?>'] = parseInt(counterVariables['<?php echo $fieldType[1];?>']);
                                        add_table_details("<?php echo $quesVal['id']; ?>",parseInt(counterVariables['<?php echo $fieldType[1];?>']));
                                        $('#answer_table_name_<?php echo $quesVal['id']; ?>_'+counterVariables['<?php echo $fieldType[1];?>']).val('<?php echo $tablePatientAnswer[$key7]['name']; ?>');
                                   </script>
                                    <?php
                                }
                            }else{ ?>
                                <script type="text/javascript">
                                    counterVariables['<?php echo $fieldType[1];?>'] = 1;
                                </script>
                               <?php } ?> 
                            <a id="addDrugMedicationSergeries" class="addRemoveIcon addmore_link" onclick="add_table_details('<?php echo $quesVal['id']?>',++counterVariables['<?php echo $fieldType[1];?>'], '<?php echo $placeholder; ?>')" ><i class="fa fa-plus-circle fa-2x"></i> Add More</a>
                                
                        <?php    }
                    // Drug Allergies, Currently Taking, Previous Sergeries Ends
                    elseif (in_array($fieldType[1], array('Hormone_Therapy','Oral_Contraceptive'))) 
                    {?>
                        <div style="display:<?php echo $show; ?>;" class="dependSub_li" <?php echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "_1'"; ?> <?php echo $parentAnswer;?>><?php echo $mandatory; echo $quesVal['question_text'];?></div>

                        <li class="grid" type="table" style="width:<?php echo $quesVal['width'] . '%'; ?>;display:<?php echo $show; ?>;" <?php echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'"; ?> validClass="<?php echo $quesVal['validate_class']; ?>" <?php echo $parentAnswer;?>>
                            <table cellpadding="0" cellspacing="0" border="0" width="100%" class="formTable" id="table_<?php echo $quesVal['id'];?>">
                                <tr>
                                    <td class="th" width="24%"><?php echo str_replace("_"," ",$fieldType[1]);?></td>
                                    <td class="th" width="16%">Age When 1st Used</td>
                                    <td class="th" width="17%">Age When Last Used</td>
                                    <td class="th" width="14%">Total Years Used</td>
                                    <td class="th" width="22%">Currently Taking?</td>
                                    <td class="th" width="6%"></td>
                                </tr>
                                
                                <tr id = "tr_1">
                                    <td id="td_1">
                                        <input onblur="ajaxSave('answer_table_<?php echo $quesVal['id'];?>[1][1used]', 'table');" type="text" name="answer_table_<?php echo $quesVal['id']; ?>[1][name]" value="<?php echo $tablePatientAnswer[1]['name'];?>" <?php echo  $maxLength; ?>>
                                    </td>
                                    <td>
                                        <select optional="false" name="answer_table_<?php echo $quesVal['id']; ?>[1][1used]" id="<?php echo $quesVal['id']; ?>_1_1used" class="select-one tableclass form-control" onchange="checkLesserGreater('1used', this.value, '<?php echo $quesVal['id']; ?>_1');" onblur="ajaxSave('answer_table_<?php echo $quesVal['id']; ?>[1][1used]', 'table');" >
                                        <option value="">Select</option>
                                        <?php
                                        for ($i = 15; $i <= 85; $i++) {
                                            $selected = '';
                                            if ($tablePatientAnswer[1]['1used'] == $i) {
                                                $selected = 'selected="selected"';
                                            }
                                        ?>
                                        <option <?php echo $selected; ?> value="<?php echo $i; ?>"><?php echo $i; ?></option>
                                        <?php
                                        }
                                        ?>
                                        </select>
                                    </td>
                                    <td>
                                        <select optional="false" name="answer_table_<?php echo $quesVal['id']; ?>[1][lastused]" id="<?php echo $quesVal['id']; ?>_1_lastused" class="select-one tableclass form-control" onchange="checkLesserGreater('lastused', this.value, '<?php echo $quesVal['id']; ?>_1');" onblur="ajaxSave('answer_table_<?php echo $quesVal['id']; ?>[1][lastused]', 'table');" >
                                            <option value="">Select</option>
                                            <?php
                                            for ($i = 15; $i <= 85; $i++) {
                                                $selected = '';
                                                if ($tablePatientAnswer[1]['lastused'] == $i) {
                                                    $selected = 'selected="selected"';
                                                }?>
                                                <option <?php echo $selected; ?> value="<?php echo $i; ?>"><?php echo $i; ?></option>
                                                <?php
                                            }
                                            ?>
                                        </select>
                                    </td>
                                    <td>
                                        <select optional="false" name="answer_table_<?php echo $quesVal['id']; ?>[1][yearused]" id="<?php echo $quesVal['id']; ?>_1_yearused"  class="select-one tableclass form-control" onchange="checkLesserGreater('yearused', this.value, '<?php echo $quesVal['id']; ?>_1');" onblur="ajaxSave('answer_table_<?php echo $quesVal['id']; ?>[1][yearused]', 'table');" >
                                            <option value="">Select</option>
                                            <?php
                                            for ($i = 0; $i <= 50; $i++) {
                                                $selected = '';
                                                if ($tablePatientAnswer[1]['yearused'] == $i) {
                                                    $selected = 'selected="selected"';
                                                }
                                            ?>
                                            <option <?php echo $selected; ?> value="<?php echo $i; ?>"><?php echo $i; ?></option>
                                            <?php
                                            }
                                            ?>
                                        </select>
                                    </td>
                                    <td>
                                        <div>
                                            <?php
                                            $currentlyTaking_n = $currentlyTaking_n = '';
                                            $class_y = $class_n = '';
                                            if ($tablePatientAnswer[1]['currently_taking'] == 'Yes') {
                                                $currentlyTaking_y = 'checked="checked"';
                                                $class_y = 'RadioSelected ';
                                            } else if ($tablePatientAnswer[1]['currently_taking'] == 'No') {
                                                $quesVal['id'].'_'.$currentlyTaking_n = 'checked="checked"';
                                                $class_n = 'RadioSelected ';
                                            }
                                            ?>
                                            <div class="col-md-5 col-sm-5 col-xs-12 btnYesNo mb15 padding-0">    
                                            <input type="radio" optional="false" class=" tableclass RadioClass" value="Yes" id="table_radio_<?php echo $quesVal['id']; ?>_1_0" name="answer_table_<?php echo $quesVal['id']; ?>[1][currently_taking]" <?php echo $currentlyTaking_y; ?>>
                                            <div onkeyup="onkeySelectButton(event, this, '', 'Yes', '1');" onclick="markTableChecked(this, 'currently_taking');" class="lft  centerButton <?php echo $class_y; ?> RadioLabelClass RadioLabelClass_table " for="1_0" id="Label_<?php echo $quesVal['id']; ?>_1_0" onblur="ajaxSave('answer_table_<?php echo $quesVal['id']; ?>[1][currently_taking]', 'table');">Yes</div>
                                            </div> 
                                            <div class="col-md-5 col-sm-5 col-xs-12 btnYesNo padding-0"> 
                                            <input type="radio" optional="false" class="tableclass RadioClass" value="No" id="table_radio_<?php echo $quesVal['id']; ?>_1_1" name="answer_table_<?php echo $quesVal['id']; ?>[1][currently_taking]" <?php echo $currentlyTaking_n; ?>>
                                            <div onkeyup="onkeySelectButton(event, this, '', 'No', '1');" onclick="markTableChecked(this, 'currently_taking');" class="rht_table centerButtonr  RadioLabelClass RadioLabelClass_table <?php echo $class_n; ?>" for="table_radio_1_1" id="Label_<?php echo $quesVal['id']; ?>_1_1" onblur="ajaxSave('answer_table_<?php echo $quesVal['id']; ?>[1][currently_taking]', 'table');">No</div>
                                        </div>
                                        </div>
                                    </td>
                                    <td>
                                    </td>
                                </tr>
                            </table>
                            <?php
                            
                            if (count($tablePatientAnswer) > 1) {
                                ksort($tablePatientAnswer);
                                foreach($tablePatientAnswer as $key8 => $val){
                                    ?>
                                    <script type="text/javascript">
                                        counterVariables['<?php echo $fieldType[1];?>'] = parseInt("<?php echo $key8;?>");
                                        counterVariables['<?php echo $fieldType[1];?>'] = parseInt(counterVariables['<?php echo $fieldType[1];?>']);
                                        add_table_details("<?php echo $quesVal['id']; ?>",parseInt(counterVariables['<?php echo $fieldType[1];?>']));
                                        $('#answer_table_name_<?php echo $quesVal['id']; ?>_'+counterVariables['<?php echo $fieldType[1];?>']).val('<?php echo $tablePatientAnswer[$key8]['name']; ?>');
                                        $('#<?php echo $quesVal['id']; ?>_'+parseInt(counterVariables['<?php echo $fieldType[1];?>'])+'_1used').val('<?php echo $tablePatientAnswer[$key8]['1used']; ?>');
                                        $('#<?php echo $quesVal['id']; ?>_'+counterVariables['<?php echo $fieldType[1];?>']+'_lastused').val('<?php echo $tablePatientAnswer[$key8]['lastused']; ?>');
                                        $('#<?php echo $quesVal['id']; ?>_'+counterVariables['<?php echo $fieldType[1];?>']+'_yearused').val('<?php echo $tablePatientAnswer[$key8]['yearused']; ?>');
                                        <?php
                                        if($tablePatientAnswer[$key8]['currently_taking'] == 'Yes'){?>
                                            $('#table_radio_<?php echo $quesVal['id']; ?>_<?php echo $key8?>_0').attr('checked',true);
                                            $('#Label_<?php echo $quesVal['id']; ?>_<?php echo $key8?>_0').addClass('RadioSelected');
                                        <?php
                                        } else {?>
                                            $('#table_radio_<?php echo $quesVal['id']; ?>_<?php echo $key8;?>_1').attr('checked',true);
                                            $('#Label_<?php echo $quesVal['id']; ?>_<?php echo $key8;?>_1').addClass('RadioSelected');
                                        <?php
                                        }?>
                                   </script>
                                    <?php
                                }
                            }?>
                            <a id="addtherapy" class="addRemoveIcon addmore_link" onclick="add_table_details('<?php echo $quesVal['id']?>',++counterVariables['<?php echo $fieldType[1];?>'])" ><i class="fa fa-plus-circle fa-2x"></i> Add More</a>
                        </li>
                    <?php
                    }
                    elseif(in_array($fieldType[1], array('Two_column_tbls'))){ ?>
                        
                        <div style="display:<?php echo $show; ?>;" class="dependSub_li" <?php echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "_1'"; ?> <?php echo $parentAnswer;?>><?php echo $mandatory; echo $quesVal['question_text'];?></div>   
                        <li class="grid" type="table" style="width:<?php echo $quesVal['width'] . '%'; ?>;display:<?php echo $show; ?>;" <?php echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'"; ?> validClass="<?php echo $quesVal['validate_class']; ?>" <?php echo $parentAnswer;?>>
                            <table cellpadding="0" cellspacing="0" border="0" width="100%" class="formTable" id="table_<?php echo $quesVal['id'];?>">
                                <tr>
                                    <td class="th" width="24%"><?php echo str_replace("_"," ",$fieldType[1]);?></td>
                                    <td class="th" width="16%">Age When 1st Used</td>
                                    <td class="th" width="17%">Age When Last Used</td>
                                    <td class="th" width="14%">Total Years Used</td>
                                    <td class="th" width="22%">Currently Taking?</td>
                                    <td class="th" width="6%"></td>
                                </tr>
                                
                                <tr id = "tr_1">
                                    <td id="td_1">
                                        <input onblur="ajaxSave('answer_table_<?php echo $quesVal['id'];?>[1][1used]', 'table');" type="text" name="answer_table_<?php echo $quesVal['id']; ?>[1][name]" value="<?php echo $tablePatientAnswer[1]['name'];?>" <?php echo  $maxLength; ?>>
                                    </td>
                                    <td>
                                        <select optional="false" name="answer_table_<?php echo $quesVal['id']; ?>[1][1used]" id="<?php echo $quesVal['id']; ?>_1_1used" class="select-one tableclass form-control" onchange="checkLesserGreater('1used', this.value, '<?php echo $quesVal['id']; ?>_1');" onblur="ajaxSave('answer_table_<?php echo $quesVal['id']; ?>[1][1used]', 'table');" >
                                        <option value="">Select</option>
                                        <?php
                                        for ($i = 15; $i <= 85; $i++) {
                                            $selected = '';
                                            if ($tablePatientAnswer[1]['1used'] == $i) {
                                                $selected = 'selected="selected"';
                                            }
                                        ?>
                                        <option <?php echo $selected; ?> value="<?php echo $i; ?>"><?php echo $i; ?></option>
                                        <?php
                                        }
                                        ?>
                                        </select>
                                    </td>
                                    <td>
                                        <select optional="false" name="answer_table_<?php echo $quesVal['id']; ?>[1][lastused]" id="<?php echo $quesVal['id']; ?>_1_lastused" class="select-one tableclass form-control" onchange="checkLesserGreater('lastused', this.value, '<?php echo $quesVal['id']; ?>_1');" onblur="ajaxSave('answer_table_<?php echo $quesVal['id']; ?>[1][lastused]', 'table');" >
                                            <option value="">Select</option>
                                            <?php
                                            for ($i = 15; $i <= 85; $i++) {
                                                $selected = '';
                                                if ($tablePatientAnswer[1]['lastused'] == $i) {
                                                    $selected = 'selected="selected"';
                                                }?>
                                                <option <?php echo $selected; ?> value="<?php echo $i; ?>"><?php echo $i; ?></option>
                                                <?php
                                            }
                                            ?>
                                        </select>
                                    </td>
                                    <td>
                                        <select optional="false" name="answer_table_<?php echo $quesVal['id']; ?>[1][yearused]" id="<?php echo $quesVal['id']; ?>_1_yearused"  class="select-one tableclass form-control" onchange="checkLesserGreater('yearused', this.value, '<?php echo $quesVal['id']; ?>_1');" onblur="ajaxSave('answer_table_<?php echo $quesVal['id']; ?>[1][yearused]', 'table');" >
                                            <option value="">Select</option>
                                            <?php
                                            for ($i = 0; $i <= 50; $i++) {
                                                $selected = '';
                                                if ($tablePatientAnswer[1]['yearused'] == $i) {
                                                    $selected = 'selected="selected"';
                                                }
                                            ?>
                                            <option <?php echo $selected; ?> value="<?php echo $i; ?>"><?php echo $i; ?></option>
                                            <?php
                                            }
                                            ?>
                                        </select>
                                    </td>
                                    <td>
                                        <div>
                                            <?php
                                            $currentlyTaking_n = $currentlyTaking_n = '';
                                            $class_y = $class_n = '';
                                            if ($tablePatientAnswer[1]['currently_taking'] == 'Yes') {
                                                $currentlyTaking_y = 'checked="checked"';
                                                $class_y = 'RadioSelected ';
                                            } else if ($tablePatientAnswer[1]['currently_taking'] == 'No') {
                                                $quesVal['id'].'_'.$currentlyTaking_n = 'checked="checked"';
                                                $class_n = 'RadioSelected ';
                                            }
                                            ?>
                                            <div class="col-md-5 col-sm-5 col-xs-12 btnYesNo mb15 padding-0">    
                                            <input type="radio" optional="false" class=" tableclass RadioClass" value="Yes" id="table_radio_<?php echo $quesVal['id']; ?>_1_0" name="answer_table_<?php echo $quesVal['id']; ?>[1][currently_taking]" <?php echo $currentlyTaking_y; ?>>
                                            <div onkeyup="onkeySelectButton(event, this, '', 'Yes', '1');" onclick="markTableChecked(this, 'currently_taking');" class="lft  centerButton <?php echo $class_y; ?> RadioLabelClass RadioLabelClass_table " for="1_0" id="Label_<?php echo $quesVal['id']; ?>_1_0" onblur="ajaxSave('answer_table_<?php echo $quesVal['id']; ?>[1][currently_taking]', 'table');">Yes</div>
                                            </div> 
                                            <div class="col-md-5 col-sm-5 col-xs-12 btnYesNo padding-0"> 
                                            <input type="radio" optional="false" class="tableclass RadioClass" value="No" id="table_radio_<?php echo $quesVal['id']; ?>_1_1" name="answer_table_<?php echo $quesVal['id']; ?>[1][currently_taking]" <?php echo $currentlyTaking_n; ?>>
                                            <div onkeyup="onkeySelectButton(event, this, '', 'No', '1');" onclick="markTableChecked(this, 'currently_taking');" class="rht_table centerButtonr  RadioLabelClass RadioLabelClass_table <?php echo $class_n; ?>" for="table_radio_1_1" id="Label_<?php echo $quesVal['id']; ?>_1_1" onblur="ajaxSave('answer_table_<?php echo $quesVal['id']; ?>[1][currently_taking]', 'table');">No</div>
                                        </div>
                                        </div>
                                    </td>
                                    <td>
                                    </td>
                                </tr>
                            </table>
                            <?php
                            
                            if (count($tablePatientAnswer) > 1) {
                                ksort($tablePatientAnswer);
                                foreach($tablePatientAnswer as $key8 => $val){
                                    ?>
                                    <script type="text/javascript">
                                        counterVariables['<?php echo $fieldType[1];?>'] = parseInt("<?php echo $key8;?>");
                                        counterVariables['<?php echo $fieldType[1];?>'] = parseInt(counterVariables['<?php echo $fieldType[1];?>']);
                                        add_table_details("<?php echo $quesVal['id']; ?>",parseInt(counterVariables['<?php echo $fieldType[1];?>']));
                                        $('#answer_table_name_<?php echo $quesVal['id']; ?>_'+counterVariables['<?php echo $fieldType[1];?>']).val('<?php echo $tablePatientAnswer[$key8]['name']; ?>');
                                        $('#<?php echo $quesVal['id']; ?>_'+parseInt(counterVariables['<?php echo $fieldType[1];?>'])+'_1used').val('<?php echo $tablePatientAnswer[$key8]['1used']; ?>');
                                        $('#<?php echo $quesVal['id']; ?>_'+counterVariables['<?php echo $fieldType[1];?>']+'_lastused').val('<?php echo $tablePatientAnswer[$key8]['lastused']; ?>');
                                        $('#<?php echo $quesVal['id']; ?>_'+counterVariables['<?php echo $fieldType[1];?>']+'_yearused').val('<?php echo $tablePatientAnswer[$key8]['yearused']; ?>');
                                        <?php
                                        if($tablePatientAnswer[$key8]['currently_taking'] == 'Yes'){?>
                                            $('#table_radio_<?php echo $quesVal['id']; ?>_<?php echo $key8?>_0').attr('checked',true);
                                            $('#Label_<?php echo $quesVal['id']; ?>_<?php echo $key8?>_0').addClass('RadioSelected');
                                        <?php
                                        } else {?>
                                            $('#table_radio_<?php echo $quesVal['id']; ?>_<?php echo $key8;?>_1').attr('checked',true);
                                            $('#Label_<?php echo $quesVal['id']; ?>_<?php echo $key8;?>_1').addClass('RadioSelected');
                                        <?php
                                        }?>
                                   </script>
                                    <?php
                                }
                            }?>
                            <a id="addtherapy" class="addRemoveIcon addmore_link" onclick="add_table_details('<?php echo $quesVal['id']?>',++counterVariables['<?php echo $fieldType[1];?>'])" ><i class="fa fa-plus-circle fa-2x"></i> Add More</a>
                        </li>                     
                    <?php }
                    elseif ($fieldType[1] == 'breast_procedure') {
                        if ($quesVal['patient_answers']) {
                            $tablePatientAnswer = unserialize($quesVal['patient_answers']);
                        }
                        ?>
                        <li type="table" style="width:<?php echo $quesVal['width'] . '%'; ?>;display:<?php echo $show; ?>;" <?php echo "id='depend_" . $quesVal['parent_ques_id'] . "_" . $quesVal['id'] . "'"; ?> validClass="<?php echo $quesVal['validate_class']; ?>">
                            <table cellpadding="0" cellspacing="0" border="0" width="100%" class="formTable" >
                                <tr>
                                    <td class="th">Breast Procedures</td>
                                    <td class="th">Age</td>
                                    <td class="th">Select Breast</td>
                                    <td class="th">Results</td>
                                </tr>
                                <?php
                                $tableArr = explode('|', $quesVal['question_answers']);

                                foreach ($tableArr as $key9 => $val) {
                                ?>
                                <?php $rowValue = str_replace(array(' ', '_', '-', '(', ')'), '', $val); ?>
                                <tr childrow="<?php echo $val; ?>" style="display:none;">
                                    <td><?php echo $val; ?></td>
                                    <td>

                                    <?php $validation = 'maxlength="2" onkeypress="ValidateMe(this,\'Numbers\',2,\'\',event)"'; ?>
                                        <input  style="width:60px;" optional="false" maxlength="2" type="text" value="<?php echo $tablePatientAnswer[$rowValue]['age']; ?>" name="answer_table_<?php echo $quesVal['id']; ?>[<?php echo $rowValue; ?>][age]" id="<?php echo $rowValue; ?>_age" class="tableclass age" <?php echo $validation; ?>  onblur="ajaxSave('answer_table_<?php echo $quesVal['id']; ?>[<?php echo $rowValue; ?>][age]', 'table');">
                                    </td>
                                    <td>
                                        <select optional="false" value="" name="answer_table_<?php echo $quesVal['id']; ?>[<?php echo $rowValue; ?>][breast_type]" id="<?php echo $rowValue . "_breast_type"; ?>"  class="select-one tableclass form-control"  onblur="ajaxSave('answer_table_<?php echo $quesVal['id']; ?>[<?php echo $rowValue; ?>][breast_type]', 'table');">
                                            <option value="">Select</option>
                                            <option value="Both" <?php
                                            if ($tablePatientAnswer[$rowValue]['breast_type'] == 'Both') {
                                                echo 'selected="selected"';
                                            }
                                            ?>>Both</option>
                                            <option value="Left" <?php
                                            if ($tablePatientAnswer[$rowValue]['breast_type'] == 'Left') {
                                            echo 'selected="selected"';
                                            }
                                            ?>>Left</option>
                                            <option value="Right" <?php
                                            if ($tablePatientAnswer[$rowValue]['breast_type'] == 'Right') {
                                            echo 'selected="selected"';
                                            }
                                            ?>>Right</option>

                                        </select>
                                    </td>
                                    <td>
                                    <?php if (!in_array($val, array('Breast Reduction', 'Breast Implant', 'Breast Reconstruction'))) { ?>
                                        <select optional="false" value="" name="answer_table_<?php echo $quesVal['id']; ?>[<?php echo $rowValue; ?>][result]" id="<?php echo $rowValue . "_result"; ?>"  class="select-one tableclass form-control"  onblur="ajaxSave('answer_table_<?php echo $quesVal['id']; ?>[<?php echo $rowValue; ?>][result]', 'table');">
                                            <option value="">Select</option>
                                            <option value="Benign" <?php 
                                            if ($tablePatientAnswer[$rowValue]['result'] == 'Benign') {
                                            echo 'selected="selected"';
                                            }
                                            ?>>Benign</option>
                                            <option value="Malignant" <?php
                                            if ($tablePatientAnswer[$rowValue]['result'] == 'Malignant') {
                                            echo 'selected="selected"';
                                            }
                                            ?>>Malignant</option>
                                            <option value="High Risk" <?php
                                            if ($tablePatientAnswer[$rowValue]['result'] == 'High Risk') {
                                            echo 'selected="selected"';
                                            }
                                            ?>>High Risk</option>
                                        </select>
                                <?php } ?>
                                    </td>
                                </tr>


                        <?php } ?>
                    </table></li>
                        <?php
                    }//if($fieldType[1] == 'harmone_therapy'){

                    break;
                default: break;
            }
													}
        }
        ?>
            </ul>
            <div class="clear"> </div>
        
        <div class="clear"> </div>
        <?php                
            $formcount = count($this->allformids);            
            $ispasscurrent = 1;            
            foreach ($this->allformids AS $idsKey => $idsVal) {
                if ($idsVal == $this->formId) {
			$question++;
			$tabindex = 'tabindex="'.$question.'"';
                        
                    if($signatureFieldExist == 'true' && $this->isMobile == true){
                        $buttonText =  "Accept & Sign";
                    }else{
                        $buttonText =   "Submit";
                    }
                    if ($idsKey > 0) {
				$back = "<div class='col-lg-3 col-md-3 col-sm-3 col-xs-12'><a href='#' name='back' id='back' class='greyBtn btn btn-default btn-block mb15 f17' onclick='loadQuestions(\"" . $this->allformids[($idsKey-1)] . "\",\"" . $this->formId . "\",\"back\");' ".$tabindex.">Back</a></div>";
                    } 
                    else if($preRegister){
                        $back = "<div class='col-lg-3 col-md-3 col-sm-3 col-xs-12'><a href='javascript:void(0)' onclick='pageBack()' name='cancel' id='cancel' title='back' class='btn btn-default btn-block mb15 f17' ".$tabindex.">Back</a></div>";
                    }
                    else if (!empty($sessionCobrand->isCheckin)) {
				$back = "<div class='col-lg-3 col-md-3 col-sm-3 col-xs-12'><a href='".$this->backurl."' name='cancel' id='cancel' class='greyBtn btn btn-default btn-block mb15 f17' title='cancel'  ".$tabindex.">Cancel</a></div>";
                    } else {
				$back = "<div class='col-lg-3 col-md-3 col-sm-3 col-xs-12'><a href='/patient/doctor/confirmappointmentlist' name='cancel' id='cancel' title='cancel' class='greyBtn btn btn-default btn-block mb15 f17'  ".$tabindex.">Cancel</a></div>";
                    }
			$question++;
			$tabindex = 'tabindex="'.$question.'"';
                        
                    if($this->isMobile == true){
                        if ($idsKey == ($formcount - 1)) {
                        $submit = "<div class='col-lg-3 col-md-3 col-sm-3 col-xs-12'><a href='#' name='submit' id='submit' title='submit' class='primaryBtn f15 btn btn-action btn-block highlight_bg f17' onclick='formSubmit(\"" . $this->formId . "\",\"\");' data-ajax='false'>".$buttonText."</a></div>";
                        }
                        if ( $idsKey < ($formcount - 1) ) {
                            $next = "<div class='col-lg-3 col-md-3 col-sm-3 col-xs-12'><a href='#' name='next' id='next' title='submit' class='primaryBtn f15 btn btn-action btn-block highlight_bg f17' onclick='formSubmit(\"" . $this->formId . "\",\"" . $this->allformids[($idsKey+1)] . "\");' data-ajax='false'>".$buttonText."</a></div>";
                        }
                    }   
                    else
                    {
                        if ($idsKey == ($formcount - 1)) {
                                    $submit = "<div class='col-lg-3 col-md-3 col-sm-3 col-xs-12'><a href='#' name='submit' id='submit' class='greenBtn btn btn-action btn-block highlight_bg f17' title='submit' onclick='saveform(\"" . $this->formId . "\");'   ".$tabindex.">".$buttonText."</a></div>";
                        }
                            $question++;
                            $tabindex = 'tabindex="'.$question.'"';
                        if ( $idsKey < ($formcount - 1) ) {
                                    $next = "<div class='col-lg-3 col-md-3 col-sm-3 col-xs-12'><a href='#' name='next' id='next' class='greenBtn btn btn-action btn-block highlight_bg f17' title='submit' onclick='loadQuestions(\"" . $this->allformids[($idsKey+1)] . "\",\"" . $this->formId . "\",\"\");'   ".$tabindex.">".$buttonText."</a></div>";
                        }
                    }
                    
                    $currentFormId  =   $this->formId;
                    $nextFormId  =   $this->allformids[($idsKey+1)];
                    
                }
            }
            $bottom = '<div class="btnPanel row"><div class="col-lg-3 col-md-3 col-sm-3 col-xs-12"><!--div added for space handling --></div>' . $back . $submit . $next . '</div>';
            echo $bottom;
            ?>
        </form>
</div>
    <?php }
?>

<!-- Added for the signature code -->
<script type="text/javascript">
    var currentFormId;
    var nextFormId;
    $(document).ready(function() {
        currentFormId = '<?php echo $currentFormId; ?>';
        nextFormId = '<?php echo $nextFormId; ?>';
    });
</script>

<script>
    function removeMarks(questionid, formid){
        //if($('#markbodypart').is(':checked')){
            var apptId = $('#apptId').val();
            clearflag = true;
            $('.fa-crosshairs').remove();
            var data = 'questionid='+questionid+'&apptid='+apptId+'&formid='+formid;
            $.ajax({
                type:"POST",
                url:"/patient/forms/clearspots",
                data : data, 
                success: function(res){
                    console.log(res);
                    coOrdinates = [];
                    console.log(coOrdinates);
                }
  });
        //}
    }
</script>

<?php //} ?>